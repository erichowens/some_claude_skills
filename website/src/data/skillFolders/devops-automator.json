{
  "name": "devops-automator",
  "type": "folder",
  "path": "devops-automator",
  "children": [
    {
      "name": "references",
      "type": "folder",
      "path": "devops-automator/references",
      "children": [
        {
          "name": "dockerfile-multistage.dockerfile",
          "type": "file",
          "path": "devops-automator/references/dockerfile-multistage.dockerfile",
          "size": 1121
        },
        {
          "name": "github-actions-patterns.yaml",
          "type": "file",
          "path": "devops-automator/references/github-actions-patterns.yaml",
          "size": 5373
        },
        {
          "name": "kubernetes-deployment.yaml",
          "type": "file",
          "path": "devops-automator/references/kubernetes-deployment.yaml",
          "size": 4606
        },
        {
          "name": "terraform-eks-module.tf",
          "type": "file",
          "path": "devops-automator/references/terraform-eks-module.tf",
          "size": 6622
        }
      ]
    },
    {
      "name": "scripts",
      "type": "folder",
      "path": "devops-automator/scripts",
      "children": [
        {
          "name": "validate-devops-skill.sh",
          "type": "file",
          "path": "devops-automator/scripts/validate-devops-skill.sh",
          "size": 5958,
          "content": "#!/bin/bash\n# DevOps Automator Skill Validation Script\n# Validates DevOps configurations for common issues\n\nset -e\n\nSKILL_DIR=\"$(dirname \"$0\")/..\"\nERRORS=0\nWARNINGS=0\n\necho \"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\"\necho \"DevOps Automator Skill Validator\"\necho \"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\"\necho \"\"\n\n# Check for GitHub Actions workflow files\ncheck_github_actions() {\n    echo \"ğŸ” Checking GitHub Actions workflows...\"\n\n    if [ -d \".github/workflows\" ]; then\n        for workflow in .github/workflows/*.yml .github/workflows/*.yaml; do\n            [ -f \"$workflow\" ] || continue\n\n            # Check for deprecated actions\n            if grep -q \"actions/checkout@v2\\|actions/checkout@v3\" \"$workflow\" 2>/dev/null; then\n                echo \"âš ï¸  WARN: $workflow uses outdated checkout action (use v4)\"\n                ((WARNINGS++))\n            fi\n\n            # Check for missing concurrency controls\n            if ! grep -q \"concurrency:\" \"$workflow\" 2>/dev/null; then\n                echo \"âš ï¸  WARN: $workflow missing concurrency control\"\n                ((WARNINGS++))\n            fi\n\n            # Check for hardcoded secrets\n            if grep -qE \"(password|secret|token):\\s*['\\\"][^{]\" \"$workflow\" 2>/dev/null; then\n                echo \"âŒ ERROR: $workflow may contain hardcoded secrets\"\n                ((ERRORS++))\n            fi\n\n            # Check for caching\n            if ! grep -q \"cache:\" \"$workflow\" 2>/dev/null; then\n                echo \"âš ï¸  WARN: $workflow missing caching (slower builds)\"\n                ((WARNINGS++))\n            fi\n        done\n    else\n        echo \"â„¹ï¸  No GitHub Actions workflows found\"\n    fi\n}\n\n# Check Dockerfile best practices\ncheck_dockerfile() {\n    echo \"\"\n    echo \"ğŸ³ Checking Dockerfiles...\"\n\n    for dockerfile in Dockerfile Dockerfile.*; do\n        [ -f \"$dockerfile\" ] || continue\n\n        # Check for USER instruction (non-root)\n        if ! grep -q \"^USER \" \"$dockerfile\" 2>/dev/null; then\n            echo \"âš ï¸  WARN: $dockerfile runs as root (add USER instruction)\"\n            ((WARNINGS++))\n        fi\n\n        # Check for HEALTHCHECK\n        if ! grep -q \"^HEALTHCHECK \" \"$dockerfile\" 2>/dev/null; then\n            echo \"âš ï¸  WARN: $dockerfile missing HEALTHCHECK\"\n            ((WARNINGS++))\n        fi\n\n        # Check for latest tag\n        if grep -qE \"^FROM .+:latest\" \"$dockerfile\" 2>/dev/null; then\n            echo \"âŒ ERROR: $dockerfile uses :latest tag (pin versions)\"\n            ((ERRORS++))\n        fi\n\n        # Check for multi-stage build\n        if [ $(grep -c \"^FROM \" \"$dockerfile\" 2>/dev/null) -lt 2 ]; then\n            echo \"â„¹ï¸  INFO: $dockerfile is not multi-stage (consider optimization)\"\n        fi\n    done\n}\n\n# Check Kubernetes manifests\ncheck_kubernetes() {\n    echo \"\"\n    echo \"â˜¸ï¸  Checking Kubernetes manifests...\"\n\n    for manifest in k8s/*.yaml k8s/**/*.yaml kubernetes/*.yaml; do\n        [ -f \"$manifest\" ] || continue\n\n        # Check for resource limits\n        if grep -q \"kind: Deployment\\|kind: StatefulSet\" \"$manifest\" 2>/dev/null; then\n            if ! grep -q \"resources:\" \"$manifest\" 2>/dev/null; then\n                echo \"âŒ ERROR: $manifest missing resource limits\"\n                ((ERRORS++))\n            fi\n        fi\n\n        # Check for liveness/readiness probes\n        if grep -q \"kind: Deployment\" \"$manifest\" 2>/dev/null; then\n            if ! grep -q \"livenessProbe:\\|readinessProbe:\" \"$manifest\" 2>/dev/null; then\n                echo \"âš ï¸  WARN: $manifest missing health probes\"\n                ((WARNINGS++))\n            fi\n        fi\n\n        # Check for security context\n        if ! grep -q \"securityContext:\" \"$manifest\" 2>/dev/null; then\n            echo \"âš ï¸  WARN: $manifest missing security context\"\n            ((WARNINGS++))\n        fi\n    done\n}\n\n# Check Terraform configurations\ncheck_terraform() {\n    echo \"\"\n    echo \"ğŸ—ï¸  Checking Terraform configurations...\"\n\n    if [ -d \"terraform\" ] || ls *.tf 1>/dev/null 2>&1; then\n        # Check for version constraints\n        if ! grep -q \"required_version\" *.tf terraform/*.tf 2>/dev/null; then\n            echo \"âš ï¸  WARN: Missing Terraform version constraint\"\n            ((WARNINGS++))\n        fi\n\n        # Check for provider version pinning\n        if ! grep -q \"version.*=.*\\\"~>\" *.tf terraform/*.tf 2>/dev/null; then\n            echo \"âš ï¸  WARN: Missing provider version pinning\"\n            ((WARNINGS++))\n        fi\n\n        # Check for sensitive variables\n        if grep -qE \"variable.*default.*=.*(password|secret|key)\" *.tf terraform/*.tf 2>/dev/null; then\n            echo \"âŒ ERROR: Sensitive defaults in Terraform variables\"\n            ((ERRORS++))\n        fi\n    else\n        echo \"â„¹ï¸  No Terraform configurations found\"\n    fi\n}\n\n# Run all checks\ncheck_github_actions\ncheck_dockerfile\ncheck_kubernetes\ncheck_terraform\n\n# Summary\necho \"\"\necho \"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\"\necho \"Validation Complete\"\necho \"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\"\necho \"Errors:   $ERRORS\"\necho \"Warnings: $WARNINGS\"\necho \"\"\n\nif [ $ERRORS -gt 0 ]; then\n    echo \"âŒ Validation FAILED - fix errors before deployment\"\n    exit 1\nelif [ $WARNINGS -gt 5 ]; then\n    echo \"âš ï¸  Validation PASSED with warnings - review recommended\"\n    exit 0\nelse\n    echo \"âœ… Validation PASSED\"\n    exit 0\nfi\n"
        }
      ]
    },
    {
      "name": "CHANGELOG.md",
      "type": "file",
      "path": "devops-automator/CHANGELOG.md",
      "size": 1522,
      "content": "# Changelog\n\nAll notable changes to the devops-automator skill will be documented in this file.\n\n## [2.0.0] - 2024-12-11\n\n### Changed\n- **BREAKING**: Restructured SKILL.md from 955 lines to 171 lines for progressive disclosure\n- Moved all large code examples to `./references/` directory\n- Expanded anti-patterns section from 5 to 15 patterns\n\n### Added\n- `references/github-actions-patterns.yaml` - Complete CI/CD pipeline with lint, test, security, build, deploy stages\n- `references/terraform-eks-module.tf` - Production-ready EKS cluster with OIDC, node groups, encryption\n- `references/kubernetes-deployment.yaml` - Deployment, Service, HPA, ArgoCD Application definitions\n- `references/dockerfile-multistage.dockerfile` - Optimized 3-stage Docker build with security best practices\n- `scripts/validate-devops-skill.sh` - Validation script for GitHub Actions, Dockerfile, K8s, Terraform\n- New anti-patterns: Running as Root, Using :latest Tags, No Health Checks, Single Point of Failure, Terraform State Local, No Concurrency Control, Ignoring Security Scanning, No Drift Detection, Overly Permissive IAM, No Observability\n- Expanded quality checklist with 12 items\n- Version number in frontmatter\n\n### Removed\n- Inline code examples (now in references/)\n- Redundant capability descriptions\n\n## [1.0.0] - 2024-12-10\n\n### Added\n- Initial release\n- CI/CD pipeline design capabilities\n- Infrastructure as code patterns\n- Container orchestration support\n- GitOps workflow patterns\n- Monitoring and observability guidance\n"
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "devops-automator/SKILL.md",
      "size": 6890,
      "content": "---\nname: devops-automator\ndescription: \"Expert DevOps engineer for CI/CD, IaC, Kubernetes, and deployment automation. Activate on: CI/CD, GitHub Actions, Terraform, Docker, Kubernetes, Helm, ArgoCD, GitOps, deployment pipeline, infrastructure as code, container orchestration. NOT for: application code (use language skills), database schema (use data-pipeline-engineer), API design (use api-architect).\"\nallowed-tools: Read,Write,Edit,Bash(docker:*,kubectl:*,terraform:*,helm:*,gh:*)\nversion: 2.0.0\n---\n\n# DevOps Automator\n\nExpert DevOps engineer specializing in CI/CD pipelines, infrastructure as code, container orchestration, and deployment automation.\n\n## Activation Triggers\n\n**Activate on:** \"CI/CD\", \"GitHub Actions\", \"deployment pipeline\", \"Terraform\", \"infrastructure as code\", \"IaC\", \"Docker\", \"Kubernetes\", \"K8s\", \"Helm\", \"container orchestration\", \"GitOps\", \"ArgoCD\", \"deployment automation\", \"secrets management\", \"monitoring setup\"\n\n**NOT for:** Application development â†’ language skills | Database design â†’ `data-pipeline-engineer` | API design â†’ `api-architect`\n\n## Quick Start\n\n1. **Define deployment strategy**: Blue/Green, Canary, or Rolling\n2. **Choose IaC tool**: Terraform for cloud resources, Helm for K8s apps\n3. **Design CI stages**: lint â†’ test â†’ security scan â†’ build â†’ deploy\n4. **Implement GitOps**: Config repo synced by ArgoCD\n5. **Add observability**: Prometheus metrics, structured logging\n\n## Core Capabilities\n\n| Domain | Tools & Technologies |\n|--------|---------------------|\n| **CI/CD** | GitHub Actions, GitLab CI, Jenkins |\n| **IaC** | Terraform, AWS CDK, Pulumi |\n| **Containers** | Docker, Kubernetes, Helm |\n| **GitOps** | ArgoCD, Flux, Kustomize |\n| **Monitoring** | Prometheus, Grafana, ELK/EFK |\n\n## Architecture Patterns\n\n### CI/CD Pipeline Flow\n```\nCode Commit â†’ Build â†’ Test â†’ Security Scan â†’ Package\n                                              â†“\nMonitor â† Release Staging â† Smoke Tests â† Deploy Dev\n                 â†“\n         Manual Approval\n                 â†“\n         Deploy Production\n```\n\n### GitOps Architecture\n```\nApp Repo â”€â”€CIâ”€â”€â–¶ Config Repo â”€â”€ArgoCDâ”€â”€â–¶ K8s Cluster\n                     â–²                        â”‚\n                     â””â”€â”€â”€â”€Continuous Syncâ”€â”€â”€â”€â”€â”˜\n```\n\n## Reference Files\n\nFull working examples are in `./references/`:\n\n| File | Description | Lines |\n|------|-------------|-------|\n| `github-actions-patterns.yaml` | Complete CI/CD pipeline | 217 |\n| `terraform-eks-module.tf` | Production EKS cluster | 282 |\n| `kubernetes-deployment.yaml` | Deployment + HPA + ArgoCD | 200 |\n| `dockerfile-multistage.dockerfile` | Optimized multi-stage build | 51 |\n\n## Anti-Patterns (AVOID These)\n\n### 1. YAML Copy-Paste Proliferation\n**Symptom**: Nearly identical workflow files duplicated across repositories\n**Fix**: Reusable workflows, Helm charts, Kustomize bases, Terraform modules\n\n### 2. Hardcoded Secrets in Code\n**Symptom**: API keys, passwords committed to git\n**Fix**: Secret managers (Vault, AWS SM), sealed secrets, env vars from secure sources\n\n### 3. No Rollback Strategy\n**Symptom**: No plan for deployment failure, manual intervention required\n**Fix**: Blue/green, canary with automated rollback, ArgoCD auto-revert\n\n### 4. Monolithic CI Pipeline\n**Symptom**: Single 45-minute pipeline rebuilding everything on every commit\n**Fix**: Parallel jobs, caching, incremental builds, path-based triggers\n\n### 5. No Resource Limits\n**Symptom**: K8s pods without CPU/memory limits consuming all host resources\n**Fix**: Always set requests/limits, use LimitRanges and ResourceQuotas\n\n### 6. Running as Root in Containers\n**Symptom**: Dockerfile without USER instruction, pods running privileged\n**Fix**: Add USER instruction, set securityContext.runAsNonRoot: true\n\n### 7. Using :latest Tags\n**Symptom**: `FROM node:latest` or `image: app:latest` in production\n**Fix**: Pin specific versions, use immutable tags with SHA digests\n\n### 8. No Health Checks\n**Symptom**: Missing HEALTHCHECK in Dockerfile, no liveness/readiness probes\n**Fix**: Add health endpoints, configure probes with appropriate timeouts\n\n### 9. Single Point of Failure\n**Symptom**: replicas: 1, no pod anti-affinity, single availability zone\n**Fix**: Multiple replicas, pod anti-affinity, topology spread constraints\n\n### 10. Terraform State in Local File\n**Symptom**: `terraform.tfstate` committed to git or stored locally\n**Fix**: Remote backend (S3+DynamoDB, Terraform Cloud, GCS)\n\n### 11. No Concurrency Control\n**Symptom**: Multiple CI runs for same branch, deployment race conditions\n**Fix**: Use concurrency groups, implement deployment locks\n\n### 12. Ignoring Security Scanning\n**Symptom**: No vulnerability scanning, no secret detection in CI\n**Fix**: Trivy, Snyk, or Grype for vulnerabilities; TruffleHog for secrets\n\n### 13. No Drift Detection\n**Symptom**: Manual changes to infrastructure, config diverges from code\n**Fix**: ArgoCD diff detection, `terraform plan` in CI, regular audits\n\n### 14. Overly Permissive IAM\n**Symptom**: IAM roles with `*` actions, service accounts with cluster-admin\n**Fix**: Principle of least privilege, IRSA for pods, audit permissions\n\n### 15. No Observability\n**Symptom**: No metrics, logs only on stdout, no alerting\n**Fix**: Export metrics, structured logging, define SLOs, configure alerts\n\n## Validation Script\n\nRun `./scripts/validate-devops-skill.sh` to check:\n- GitHub Actions workflows for deprecated actions, missing caching\n- Dockerfiles for security best practices\n- Kubernetes manifests for resource limits, security contexts\n- Terraform for version constraints, sensitive defaults\n\n## Quality Checklist\n\n```\n[ ] All secrets in secret management (not in code)\n[ ] Resource limits defined for all containers\n[ ] Health checks configured (liveness, readiness)\n[ ] Horizontal pod autoscaling enabled\n[ ] Security contexts set (non-root, read-only)\n[ ] Monitoring and alerting configured\n[ ] Rollback strategy documented\n[ ] Multi-environment support (dev, staging, prod)\n[ ] Concurrency controls in CI pipelines\n[ ] Remote state backend for Terraform\n[ ] Vulnerability scanning in pipeline\n[ ] Version pinning for all dependencies\n```\n\n## Output Artifacts\n\n1. **CI/CD Workflows** - GitHub Actions, GitLab CI configs\n2. **Terraform Modules** - Reusable infrastructure components\n3. **Kubernetes Manifests** - Deployments, services, configs\n4. **Helm Charts** - Packaged applications\n5. **Docker Configurations** - Optimized multi-stage builds\n6. **ArgoCD Applications** - GitOps deployment definitions\n\n## Tools Available\n\n- `Read`, `Write`, `Edit` - File operations for configs and manifests\n- `Bash(docker:*)` - Build and manage containers\n- `Bash(kubectl:*)` - Kubernetes operations\n- `Bash(terraform:*)` - Infrastructure provisioning\n- `Bash(helm:*)` - Helm chart management\n- `Bash(gh:*)` - GitHub CLI operations\n"
    }
  ]
}