{
  "name": "data-viz-2025",
  "type": "folder",
  "path": "data-viz-2025",
  "children": [
    {
      "name": "assets",
      "type": "folder",
      "path": "data-viz-2025/assets",
      "children": [
        {
          "name": "example-chart.tsx",
          "type": "file",
          "path": "data-viz-2025/assets/example-chart.tsx",
          "size": 7410,
          "content": "/**\n * Example: Production-Ready Animated Bar Chart\n *\n * This component demonstrates 2025 data viz best practices:\n * - Tufte principles (high data-ink ratio)\n * - Smooth animations with spring physics\n * - Accessibility (keyboard nav, screen reader support)\n * - Responsive design\n * - Loading states (skeleton, not spinner)\n * - Error handling\n * - TypeScript types\n *\n * Stack: Recharts + Framer Motion + Tailwind CSS\n */\n\nimport { motion, useReducedMotion } from 'framer-motion';\nimport {\n  BarChart,\n  Bar,\n  XAxis,\n  YAxis,\n  Tooltip,\n  ResponsiveContainer\n} from 'recharts';\n\ninterface DataPoint {\n  category: string;\n  value: number;\n  insight?: string;\n}\n\ninterface AnimatedBarChartProps {\n  data: DataPoint[];\n  title?: string;\n  description?: string;\n  highlightCategory?: string;\n  isLoading?: boolean;\n  error?: Error;\n}\n\nexport function AnimatedBarChart({\n  data,\n  title = 'Data Visualization',\n  description,\n  highlightCategory,\n  isLoading = false,\n  error\n}: AnimatedBarChartProps) {\n  const shouldReduceMotion = useReducedMotion();\n\n  // Loading State: Skeleton loader\n  if (isLoading) {\n    return <ChartSkeleton />;\n  }\n\n  // Error State\n  if (error) {\n    return (\n      <div\n        className=\"rounded-lg border border-red-200 bg-red-50 p-6\"\n        role=\"alert\"\n      >\n        <h3 className=\"font-semibold text-red-900\">Error loading chart</h3>\n        <p className=\"text-sm text-red-700\">{error.message}</p>\n      </div>\n    );\n  }\n\n  // Empty State\n  if (!data || data.length === 0) {\n    return (\n      <div\n        className=\"rounded-lg border border-gray-200 bg-gray-50 p-12 text-center\"\n        data-testid=\"empty-state\"\n      >\n        <p className=\"text-gray-600\">No data to display</p>\n      </div>\n    );\n  }\n\n  return (\n    <figure\n      role=\"img\"\n      aria-labelledby=\"chart-title\"\n      aria-describedby=\"chart-desc\"\n      className=\"rounded-lg border border-gray-200 bg-white p-6 shadow-sm\"\n    >\n      {/* Entrance animation */}\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{\n          type: shouldReduceMotion ? undefined : 'spring',\n          duration: shouldReduceMotion ? 0 : 0.5,\n          stiffness: 300,\n          damping: 30\n        }}\n      >\n        {/* Title & Description */}\n        <div className=\"mb-6\">\n          <h2 id=\"chart-title\" className=\"text-2xl font-semibold text-gray-900\">\n            {title}\n          </h2>\n          {description && (\n            <p id=\"chart-desc\" className=\"mt-2 text-sm text-gray-600\">\n              {description}\n            </p>\n          )}\n        </div>\n\n        {/* Chart */}\n        <ResponsiveContainer width=\"100%\" height={400}>\n          <BarChart\n            data={data}\n            margin={{ top: 20, right: 30, left: 20, bottom: 60 }}\n          >\n            {/* Minimal gridlines (Tufte principle) */}\n            <XAxis\n              dataKey=\"category\"\n              stroke=\"#d1d5db\"\n              strokeWidth={1}\n              tick={{ fill: '#6b7280', fontSize: 12 }}\n              angle={-45}\n              textAnchor=\"end\"\n            />\n            <YAxis\n              stroke=\"#d1d5db\"\n              strokeWidth={1}\n              tick={{ fill: '#6b7280', fontSize: 12 }}\n            />\n\n            {/* Tooltip with insight */}\n            <Tooltip\n              content={<CustomTooltip />}\n              cursor={{ fill: 'rgba(0, 0, 0, 0.05)' }}\n            />\n\n            {/* Bars with conditional highlighting */}\n            <Bar\n              dataKey=\"value\"\n              fill={(entry: DataPoint) =>\n                entry.category === highlightCategory\n                  ? '#d97706' // Ember orange for highlight\n                  : '#9ca3af' // Gray for others\n              }\n              radius={[4, 4, 0, 0]}\n              data-testid=\"bar\"\n              animationDuration={shouldReduceMotion ? 0 : 800}\n              animationEasing=\"ease-out\"\n            />\n          </BarChart>\n        </ResponsiveContainer>\n\n        {/* Provide data table alternative for screen readers */}\n        <details className=\"mt-6\">\n          <summary className=\"cursor-pointer text-sm text-gray-600 hover:text-gray-900\">\n            View data table\n          </summary>\n          <table className=\"mt-4 w-full border-collapse text-sm\">\n            <thead>\n              <tr className=\"border-b border-gray-200\">\n                <th className=\"py-2 text-left font-semibold\">Category</th>\n                <th className=\"py-2 text-right font-semibold\">Value</th>\n              </tr>\n            </thead>\n            <tbody>\n              {data.map(row => (\n                <tr key={row.category} className=\"border-b border-gray-100\">\n                  <td className=\"py-2\">{row.category}</td>\n                  <td className=\"py-2 text-right\">\n                    {row.value.toLocaleString()}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </details>\n      </motion.div>\n    </figure>\n  );\n}\n\n/**\n * Custom Tooltip with Insight\n */\nfunction CustomTooltip({ active, payload }: any) {\n  if (!active || !payload || !payload.length) return null;\n\n  const data: DataPoint = payload[0].payload;\n\n  return (\n    <motion.div\n      className=\"rounded-lg border border-gray-200 bg-white p-3 shadow-lg\"\n      initial={{ opacity: 0, scale: 0.9 }}\n      animate={{ opacity: 1, scale: 1 }}\n      exit={{ opacity: 0, scale: 0.9 }}\n      transition={{ duration: 0.15 }}\n    >\n      <p className=\"font-semibold text-gray-900\">{data.category}</p>\n      <p className=\"text-2xl font-bold text-ember-600\">\n        {data.value.toLocaleString()}\n      </p>\n      {data.insight && (\n        <p className=\"mt-1 text-xs text-gray-600\">{data.insight}</p>\n      )}\n    </motion.div>\n  );\n}\n\n/**\n * Skeleton Loader (Tufte-approved: shows structure, not spinner)\n */\nfunction ChartSkeleton() {\n  return (\n    <div className=\"rounded-lg border border-gray-200 bg-white p-6 shadow-sm\">\n      {/* Title skeleton */}\n      <div className=\"mb-6\">\n        <div className=\"h-8 w-48 animate-pulse rounded bg-gray-200\" />\n        <div className=\"mt-2 h-4 w-96 animate-pulse rounded bg-gray-100\" />\n      </div>\n\n      {/* Chart skeleton */}\n      <div className=\"flex h-[400px] items-end justify-around gap-4\">\n        {[60, 80, 45, 90, 70, 55].map((height, i) => (\n          <motion.div\n            key={i}\n            className=\"w-full rounded-t bg-gray-200\"\n            style={{ height: `${height}%` }}\n            animate={{ opacity: [0.3, 0.6, 0.3] }}\n            transition={{\n              duration: 1.5,\n              repeat: Infinity,\n              delay: i * 0.1\n            }}\n          />\n        ))}\n      </div>\n\n      {/* Axis labels skeleton */}\n      <div className=\"mt-4 flex justify-around\">\n        {Array.from({ length: 6 }).map((_, i) => (\n          <div key={i} className=\"h-3 w-12 animate-pulse rounded bg-gray-100\" />\n        ))}\n      </div>\n    </div>\n  );\n}\n\n/**\n * Usage Example:\n *\n * const salesData = [\n *   { category: 'Mobile', value: 1200000, insight: '+68% YoY' },\n *   { category: 'Desktop', value: 800000, insight: '-12% YoY' },\n *   { category: 'Tablet', value: 400000, insight: 'Stable' }\n * ];\n *\n * <AnimatedBarChart\n *   data={salesData}\n *   title=\"Q4 Sales by Channel\"\n *   description=\"Mobile now drives 60% of revenue\"\n *   highlightCategory=\"Mobile\"\n * />\n */\n"
        }
      ]
    },
    {
      "name": "references",
      "type": "folder",
      "path": "data-viz-2025/references",
      "children": [
        {
          "name": "animation-patterns.md",
          "type": "file",
          "path": "data-viz-2025/references/animation-patterns.md",
          "size": 14362,
          "content": "# Animation Patterns for Data Visualizations\n\nMotion communicates. In data visualizations, animations guide attention, reveal relationships, and delight users. This guide covers modern animation patterns for 2025.\n\n## Animation Philosophy\n\n### Why Animate Data Viz?\n\n1. **Draw Attention** - Guide the eye to insights\n2. **Show Relationships** - Morphing between views reveals structure\n3. **Reduce Cognitive Load** - Smooth transitions help users track changes\n4. **Premium Feel** - Thoughtful motion = professional application\n\n### When NOT to Animate\n\n- ‚ùå **Print visualizations** - Static medium\n- ‚ùå **Accessibility concern** - When `prefers-reduced-motion: reduce`\n- ‚ùå **Performance critical** - Large datasets (>10K points)\n- ‚ùå **Just decoration** - Motion without purpose\n\n## Spring Physics vs. Easing Curves\n\n### Linear Easing (‚ùå Never Use)\n\n```typescript\n// ‚ùå BAD - Feels robotic\ntransition: 'all 0.3s linear'\n```\n\n### Ease-Out (‚ö†Ô∏è Acceptable)\n\n```typescript\n// ‚ö†Ô∏è OK - But not exciting\ntransition: 'all 0.3s ease-out'\n```\n\n### Spring Physics (‚úÖ Best)\n\n```typescript\n// ‚úÖ GOOD - Natural, bouncy, delightful\nimport { motion } from 'framer-motion';\n\n<motion.div\n  initial={{ opacity: 0, y: 20 }}\n  animate={{ opacity: 1, y: 0 }}\n  transition={{\n    type: \"spring\",\n    stiffness: 300,\n    damping: 30\n  }}\n>\n  {chart}\n</motion.div>\n```\n\n**Why springs feel better:**\n- Mimic real-world physics\n- No artificial \"stopping point\" (ease curves feel abrupt)\n- Automatically adjust to interruptions (user interrupts animation mid-way)\n\n## Essential Animation Patterns\n\n### 1. Entrance Animations (Draw-In)\n\n**Line Chart Drawing In:**\n\n```typescript\nimport { motion } from 'framer-motion';\n\nconst LineChart = ({ data }) => {\n  return (\n    <svg width={640} height={400}>\n      <motion.path\n        d={generatePath(data)}\n        fill=\"none\"\n        stroke=\"#d97706\"\n        strokeWidth={2}\n        initial={{ pathLength: 0 }}\n        animate={{ pathLength: 1 }}\n        transition={{ duration: 1.5, ease: \"easeInOut\" }}\n      />\n    </svg>\n  );\n};\n```\n\n**Bars Growing Up:**\n\n```typescript\nconst BarChart = ({ data }) => {\n  return (\n    <svg width={640} height={400}>\n      {data.map((d, i) => (\n        <motion.rect\n          key={d.category}\n          x={i * 40}\n          y={400 - d.value}\n          width={30}\n          height={d.value}\n          fill=\"#d97706\"\n          initial={{ height: 0, y: 400 }}\n          animate={{ height: d.value, y: 400 - d.value }}\n          transition={{\n            type: \"spring\",\n            stiffness: 200,\n            damping: 20,\n            delay: i * 0.1 // Stagger\n          }}\n        />\n      ))}\n    </svg>\n  );\n};\n```\n\n### 2. Staggered Animations\n\nAnimate multiple elements with a delay between each.\n\n```typescript\nconst container = {\n  hidden: { opacity: 0 },\n  show: {\n    opacity: 1,\n    transition: {\n      delayChildren: 0.1,\n      staggerChildren: 0.05  // 50ms between each child\n    }\n  }\n};\n\nconst item = {\n  hidden: { opacity: 0, y: 20 },\n  show: { opacity: 1, y: 0 }\n};\n\n<motion.div variants={container} initial=\"hidden\" animate=\"show\">\n  {data.map(d => (\n    <motion.div key={d.id} variants={item}>\n      {d.value}\n    </motion.div>\n  ))}\n</motion.div>\n```\n\n### 3. Data Update Transitions\n\n**Smooth Value Changes:**\n\n```typescript\nimport { animate } from 'framer-motion';\nimport { useEffect, useState } from 'react';\n\nconst AnimatedNumber = ({ value }: { value: number }) => {\n  const [displayValue, setDisplayValue] = useState(value);\n\n  useEffect(() => {\n    const controls = animate(displayValue, value, {\n      duration: 0.5,\n      onUpdate: v => setDisplayValue(Math.round(v))\n    });\n\n    return controls.stop;\n  }, [value]);\n\n  return <span>{displayValue.toLocaleString()}</span>;\n};\n```\n\n**Morphing Bars:**\n\n```typescript\nconst Bar = ({ height, y }: Props) => (\n  <motion.rect\n    animate={{ height, y }}\n    transition={{ type: \"spring\", stiffness: 300, damping: 30 }}\n  />\n);\n```\n\n### 4. Tooltip Animations\n\n**Fade + Scale:**\n\n```typescript\n<motion.div\n  className=\"tooltip\"\n  initial={{ opacity: 0, scale: 0.8 }}\n  animate={{ opacity: 1, scale: 1 }}\n  exit={{ opacity: 0, scale: 0.8 }}\n  transition={{ duration: 0.15 }}\n>\n  {content}\n</motion.div>\n```\n\n**Slide From Side:**\n\n```typescript\n<motion.div\n  className=\"tooltip\"\n  initial={{ opacity: 0, x: -10 }}\n  animate={{ opacity: 1, x: 0 }}\n  exit={{ opacity: 0, x: -10 }}\n  transition={{ type: \"spring\", stiffness: 400, damping: 30 }}\n>\n  {content}\n</motion.div>\n```\n\n### 5. Hover Micro-interactions\n\n**Scale on Hover:**\n\n```typescript\n<motion.rect\n  whileHover={{ scale: 1.05 }}\n  whileTap={{ scale: 0.95 }}\n  transition={{ type: \"spring\", stiffness: 400, damping: 30 }}\n/>\n```\n\n**Glow Effect:**\n\n```typescript\n<motion.circle\n  whileHover={{\n    boxShadow: \"0 0 20px rgba(217, 119, 6, 0.6)\"\n  }}\n/>\n```\n\n**Lift Effect (Chart Cards):**\n\n```typescript\n<motion.div\n  className=\"chart-card\"\n  whileHover={{\n    y: -4,\n    boxShadow: \"0 20px 40px rgba(0,0,0,0.1)\"\n  }}\n  transition={{ type: \"spring\", stiffness: 300, damping: 30 }}\n>\n  {chart}\n</motion.div>\n```\n\n### 6. Loading States (Skeleton Loaders)\n\n**Shimmer Effect:**\n\n```typescript\n<motion.rect\n  x={0}\n  y={0}\n  width={200}\n  height={300}\n  fill=\"url(#shimmer)\"\n  rx={4}\n/>\n\n<defs>\n  <linearGradient id=\"shimmer\">\n    <stop offset=\"0%\" stopColor=\"#f0f0f0\" />\n    <motion.stop\n      offset=\"50%\"\n      stopColor=\"#e0e0e0\"\n      animate={{\n        offset: [\"0%\", \"100%\"]\n      }}\n      transition={{\n        duration: 1.5,\n        repeat: Infinity,\n        ease: \"linear\"\n      }}\n    />\n    <stop offset=\"100%\" stopColor=\"#f0f0f0\" />\n  </linearGradient>\n</defs>\n```\n\n**Pulse:**\n\n```typescript\n<motion.div\n  className=\"skeleton-bar\"\n  animate={{ opacity: [0.5, 1, 0.5] }}\n  transition={{\n    duration: 1.5,\n    repeat: Infinity,\n    ease: \"easeInOut\"\n  }}\n/>\n```\n\n### 7. Filter/Sort Animations\n\n**Layout Animations (Auto-animate):**\n\n```typescript\nimport { motion, AnimatePresence } from 'framer-motion';\n\n<AnimatePresence>\n  {filteredData.map(item => (\n    <motion.div\n      key={item.id}\n      layout  // Auto-animate position changes\n      initial={{ opacity: 0, scale: 0.8 }}\n      animate={{ opacity: 1, scale: 1 }}\n      exit={{ opacity: 0, scale: 0.8 }}\n      transition={{ type: \"spring\" }}\n    >\n      {item.content}\n    </motion.div>\n  ))}\n</AnimatePresence>\n```\n\n### 8. Scrollytelling Animations\n\n**Animate on Scroll:**\n\n```typescript\nimport { motion, useScroll, useTransform } from 'framer-motion';\n\nconst ScrollChart = () => {\n  const { scrollYProgress } = useScroll();\n\n  const opacity = useTransform(scrollYProgress, [0, 0.5, 1], [0, 1, 0]);\n  const scale = useTransform(scrollYProgress, [0, 0.5, 1], [0.8, 1, 0.8]);\n\n  return (\n    <motion.div style={{ opacity, scale }}>\n      {chart}\n    </motion.div>\n  );\n};\n```\n\n**Reveal Data Points as User Scrolls:**\n\n```typescript\nconst DataPoint = ({ value, scrollProgress }: Props) => {\n  const opacity = useTransform(scrollProgress, [0.3, 0.5], [0, 1]);\n  const y = useTransform(scrollProgress, [0.3, 0.5], [20, 0]);\n\n  return (\n    <motion.circle\n      style={{ opacity, y }}\n      cx={x}\n      cy={y}\n      r={5}\n    />\n  );\n};\n```\n\n## Advanced Patterns\n\n### 9. Morphing Between Chart Types\n\nTransform a bar chart into a line chart:\n\n```typescript\nimport { motion } from 'framer-motion';\n\nconst MorphingChart = ({ type }: { type: 'bar' | 'line' }) => {\n  return (\n    <svg width={640} height={400}>\n      <AnimatePresence mode=\"wait\">\n        {type === 'bar' ? (\n          <motion.g\n            key=\"bars\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n          >\n            {/* Bar elements */}\n          </motion.g>\n        ) : (\n          <motion.g\n            key=\"line\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n          >\n            {/* Line element */}\n          </motion.g>\n        )}\n      </AnimatePresence>\n    </svg>\n  );\n};\n```\n\n### 10. Particle Effects\n\nCelebrate milestones with confetti:\n\n```typescript\nimport confetti from 'canvas-confetti';\n\nconst celebrate = () => {\n  confetti({\n    particleCount: 100,\n    spread: 70,\n    origin: { y: 0.6 }\n  });\n};\n\n<button onClick={() => {\n  updateData();\n  celebrate();  // Visual reward for hitting goal\n}}>\n  Update Chart\n</button>\n```\n\n### 11. Path Animations (Complex Shapes)\n\nAnimate along a path:\n\n```typescript\n<motion.circle\n  cx={0}\n  cy={0}\n  r={5}\n  fill=\"#d97706\"\n>\n  <animateMotion\n    dur=\"3s\"\n    repeatCount=\"indefinite\"\n    path=\"M 0 0 L 100 100 L 200 50 L 300 150\"\n  />\n</motion.circle>\n```\n\n## Accessibility: Respecting Reduced Motion\n\n**Always check `prefers-reduced-motion`:**\n\n```typescript\nimport { useReducedMotion } from 'framer-motion';\n\nconst Chart = () => {\n  const shouldReduceMotion = useReducedMotion();\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      transition={{\n        duration: shouldReduceMotion ? 0 : 0.5,\n        type: shouldReduceMotion ? undefined : \"spring\"\n      }}\n    >\n      {chart}\n    </motion.div>\n  );\n};\n```\n\n**CSS Media Query:**\n\n```css\n@media (prefers-reduced-motion: reduce) {\n  * {\n    animation-duration: 0.01ms !important;\n    animation-iteration-count: 1 !important;\n    transition-duration: 0.01ms !important;\n  }\n}\n```\n\n## Performance Optimization\n\n### Use `will-change` for GPU Acceleration\n\n```css\n.animated-chart {\n  will-change: transform, opacity;\n}\n```\n\n### Limit Concurrent Animations\n\n```typescript\n// ‚ùå BAD - Animating 1000 elements at once\n{data.map((d, i) => (\n  <motion.rect animate={{ ... }} />\n))}\n\n// ‚úÖ GOOD - Animate in batches or use Canvas\n{data.length < 100 ? (\n  data.map(d => <motion.rect animate={{ ... }} />)\n) : (\n  <CanvasChart data={data} />  // No individual SVG elements\n)}\n```\n\n### Debounce Rapid Updates\n\n```typescript\nimport { useDebouncedValue } from '@mantine/hooks';\n\nconst Chart = ({ data }: Props) => {\n  const [debouncedData] = useDebouncedValue(data, 200);\n\n  return <AnimatedChart data={debouncedData} />;\n};\n```\n\n## Animation Timing Reference\n\n| Duration | Use Case |\n|----------|----------|\n| 0-100ms | Micro-interactions (hover, tap feedback) |\n| 100-300ms | Small transitions (tooltip appear, button states) |\n| 300-500ms | Medium transitions (data updates, filters) |\n| 500ms-1s | Large transitions (chart type changes, page transitions) |\n| 1-2s | Entrance animations (first render, data loading complete) |\n| 2s+ | Scrollytelling, storytelling sequences |\n\n## Common Mistakes\n\n### ‚ùå Over-Animation\n\n```typescript\n// Too much motion - distracting\n<motion.div\n  animate={{\n    scale: [1, 1.2, 0.8, 1.1, 0.9, 1],\n    rotate: [0, 10, -10, 5, -5, 0],\n    x: [0, 50, -50, 0]\n  }}\n  transition={{ duration: 0.5 }}\n/>\n```\n\n### ‚ùå Inconsistent Timing\n\n```typescript\n// Different durations for similar elements - jarring\n<motion.rect transition={{ duration: 0.3 }} />\n<motion.rect transition={{ duration: 0.8 }} />\n<motion.rect transition={{ duration: 0.5 }} />\n```\n\n### ‚ùå Animations Without Purpose\n\n```typescript\n// Why is this rotating? No semantic meaning.\n<motion.text animate={{ rotate: 360 }} />\n```\n\n## Best Practices Summary\n\n1. **Use spring physics** - More natural than easing curves\n2. **Stagger for multiple elements** - Don't animate all at once\n3. **Respect `prefers-reduced-motion`** - Accessibility requirement\n4. **Keep durations consistent** - Similar elements = similar timing\n5. **Purpose over decoration** - Every animation should communicate\n6. **Test performance** - Large datasets may need Canvas or no animation\n7. **Loading states > spinners** - Skeleton loaders are better UX\n\n## Framer Motion Cheat Sheet\n\n```typescript\n// Basic animation\n<motion.div\n  initial={{ opacity: 0 }}\n  animate={{ opacity: 1 }}\n  exit={{ opacity: 0 }}\n  transition={{ duration: 0.3 }}\n/>\n\n// Spring physics\ntransition={{ type: \"spring\", stiffness: 300, damping: 30 }}\n\n// Stagger children\nconst container = {\n  hidden: { opacity: 0 },\n  show: {\n    opacity: 1,\n    transition: { staggerChildren: 0.1 }\n  }\n};\n\n// Hover/Tap\n<motion.div\n  whileHover={{ scale: 1.05 }}\n  whileTap={{ scale: 0.95 }}\n/>\n\n// Layout animations (auto-animate position)\n<motion.div layout />\n\n// Scroll-driven animations\nconst { scrollYProgress } = useScroll();\nconst opacity = useTransform(scrollYProgress, [0, 1], [0, 1]);\n\n// Reduced motion\nconst shouldReduceMotion = useReducedMotion();\n```\n\n## Resources\n\n- [Framer Motion Documentation](https://www.framer.com/motion/)\n- [React Spring](https://www.react-spring.dev/)\n- [Theater.js](https://www.theatrejs.com/) - For complex animation sequences\n- [Lottie](https://lottiefiles.com/) - For After Effects animations\n- [GSAP](https://gsap.com/) - Industry-standard animation library\n\n## Example: Complete Animated Dashboard Card\n\n```typescript\nimport { motion, useReducedMotion } from 'framer-motion';\n\nexport const DashboardCard = ({ title, value, trend, data }) => {\n  const shouldReduceMotion = useReducedMotion();\n\n  return (\n    <motion.div\n      className=\"card\"\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{\n        type: shouldReduceMotion ? undefined : \"spring\",\n        duration: shouldReduceMotion ? 0 : 0.5\n      }}\n      whileHover={shouldReduceMotion ? undefined : {\n        y: -4,\n        boxShadow: \"0 20px 40px rgba(0,0,0,0.1)\"\n      }}\n    >\n      <h3>{title}</h3>\n\n      <motion.div\n        className=\"value\"\n        initial={{ scale: 0.8, opacity: 0 }}\n        animate={{ scale: 1, opacity: 1 }}\n        transition={{ delay: 0.2 }}\n      >\n        <AnimatedNumber value={value} />\n      </motion.div>\n\n      <motion.div\n        className=\"trend\"\n        initial={{ opacity: 0, x: -10 }}\n        animate={{ opacity: 1, x: 0 }}\n        transition={{ delay: 0.3 }}\n      >\n        {trend > 0 ? '‚Üë' : '‚Üì'} {Math.abs(trend)}%\n      </motion.div>\n\n      <svg width=\"100%\" height={80}>\n        <motion.path\n          d={generateSparkline(data)}\n          fill=\"none\"\n          stroke=\"#d97706\"\n          strokeWidth={2}\n          initial={{ pathLength: 0 }}\n          animate={{ pathLength: 1 }}\n          transition={{ duration: 1, delay: 0.4 }}\n        />\n      </svg>\n    </motion.div>\n  );\n};\n```\n\nRemember: **Motion with purpose > Motion for motion's sake**\n"
        },
        {
          "name": "data-storytelling.md",
          "type": "file",
          "path": "data-viz-2025/references/data-storytelling.md",
          "size": 14023,
          "content": "# Data Storytelling: Turning Charts into Narratives\n\nData alone doesn't persuade. Stories persuade. This guide teaches you how to transform visualizations into compelling narratives that drive action.\n\n## The Narrative Arc for Data\n\nEvery data story follows a structure:\n\n```\n1. HOOK       ‚Üí What's the surprising insight?\n2. CONTEXT    ‚Üí Why should we care?\n3. EVIDENCE   ‚Üí Show the data clearly\n4. CONCLUSION ‚Üí What should we do?\n```\n\n### Example: Bad vs. Good\n\n**‚ùå Bad (Just Data):**\n> \"Here's our Q4 sales data in a bar chart.\"\n\n**‚úÖ Good (Data Story):**\n> \"Our mobile sales doubled in Q4, now accounting for 60% of revenue. This shift caught us off guard‚Äîour mobile experience isn't optimized for this volume. We need to prioritize mobile checkout improvements in Q1.\"\n\n## Core Storytelling Techniques\n\n### 1. Start with the Insight, Not the Data\n\n**‚ùå Data-First Approach:**\n```typescript\n<BarChart data={sales} title=\"Q4 Sales by Channel\" />\n```\n*User must discover the insight themselves*\n\n**‚úÖ Insight-First Approach:**\n```typescript\n<div className=\"insight-card\">\n  <h2>Mobile Sales Doubled in Q4</h2>\n  <p className=\"insight\">\n    Mobile now drives 60% of revenue, up from 30% last quarter\n  </p>\n  <BarChart\n    data={sales}\n    highlightCategory=\"Mobile\"\n    annotation=\"2x growth\"\n  />\n</div>\n```\n*Insight is immediate, chart provides evidence*\n\n### 2. Use Annotations to Guide the Eye\n\nDon't make users hunt for insights. Point them out.\n\n```typescript\n<LineChart data={revenue}>\n  <ReferenceLine\n    x=\"2020-03-15\"\n    stroke=\"#dc2626\"\n    label=\"Pandemic Declared\"\n  />\n  <ReferenceLine\n    y={1000000}\n    stroke=\"#059669\"\n    label=\"$1M Milestone\"\n    strokeDasharray=\"5 5\"\n  />\n  <ReferenceArea\n    x1=\"2020-06\"\n    x2=\"2020-09\"\n    fill=\"#fef3c7\"\n    fillOpacity={0.3}\n    label=\"Recovery Period\"\n  />\n</LineChart>\n```\n\n### 3. Comparison Over Absolute Values\n\n**‚ùå Hard to Interpret:**\n> \"We had 45,832 visitors in January and 52,193 in February.\"\n\n**‚úÖ Easy to Grasp:**\n> \"Visitors increased 14% month-over-month (from 45K to 52K).\"\n\n```typescript\n<div className=\"comparison-card\">\n  <div className=\"metric\">\n    <span className=\"value\">52K</span>\n    <span className=\"change positive\">+14% ‚Üë</span>\n  </div>\n  <div className=\"vs\">vs. 45K last month</div>\n</div>\n```\n\n### 4. Progressive Disclosure\n\nReveal complexity gradually. Start simple, allow drilling down.\n\n```typescript\n// Level 1: Simple headline number\n<div className=\"kpi\">\n  <span className=\"value\">$2.3M</span>\n  <span className=\"label\">Q4 Revenue</span>\n</div>\n\n// Level 2: Expand to show trend\n<details>\n  <summary>View trend</summary>\n  <LineChart data={quarterlyRevenue} height={150} />\n</details>\n\n// Level 3: Full breakdown\n<details>\n  <summary>View breakdown by channel</summary>\n  <BarChart data={revenueByChannel} height={300} />\n</details>\n```\n\n## Scrollytelling: Data Stories That Unfold\n\nAnimate visualizations as the user scrolls through a narrative.\n\n### Basic Scrollytelling Pattern\n\n```typescript\nimport { motion, useScroll, useTransform } from 'framer-motion';\nimport { useRef } from 'react';\n\nexport const ScrollytellingChart = () => {\n  const containerRef = useRef(null);\n  const { scrollYProgress } = useScroll({\n    target: containerRef,\n    offset: [\"start end\", \"end start\"]\n  });\n\n  const opacity = useTransform(scrollYProgress, [0, 0.2, 0.8, 1], [0, 1, 1, 0]);\n  const scale = useTransform(scrollYProgress, [0, 0.2, 0.8, 1], [0.8, 1, 1, 0.8]);\n\n  return (\n    <div ref={containerRef} className=\"min-h-screen flex items-center\">\n      <motion.div style={{ opacity, scale }}>\n        <LineChart data={data} />\n      </motion.div>\n    </div>\n  );\n};\n```\n\n### Advanced: Reveal Data Points as User Scrolls\n\n```typescript\nexport const RevealingChart = () => {\n  const { scrollYProgress } = useScroll();\n\n  const visibleDataPoints = useTransform(\n    scrollYProgress,\n    [0, 1],\n    [0, data.length]\n  );\n\n  return (\n    <div className=\"min-h-[200vh]\">\n      <div className=\"sticky top-0 h-screen flex items-center\">\n        <Chart\n          data={data.slice(0, visibleDataPoints.get())}\n        />\n      </div>\n\n      <div className=\"narrative\">\n        <section>In January, sales started slow...</section>\n        <section>But by March, growth accelerated...</section>\n        <section>Q2 saw explosive growth...</section>\n      </div>\n    </div>\n  );\n};\n```\n\n### Libraries for Scrollytelling\n\n- **Framer Motion** - `useScroll()` hook for scroll-driven animations\n- **react-scroll-parallax** - Parallax effects\n- **Intersection Observer API** - Trigger animations when elements enter viewport\n\n## The \"Before & After\" Pattern\n\nShow the impact of changes by comparing states.\n\n```typescript\n<div className=\"before-after\">\n  <div className=\"before\">\n    <h3>Before Optimization</h3>\n    <BarChart data={beforeData} color=\"#dc2626\" />\n    <p className=\"metric\">Avg Load Time: 3.2s</p>\n  </div>\n\n  <div className=\"arrow\">‚Üí</div>\n\n  <div className=\"after\">\n    <h3>After Optimization</h3>\n    <BarChart data={afterData} color=\"#059669\" />\n    <p className=\"metric\">Avg Load Time: 0.8s</p>\n    <p className=\"improvement\">75% faster ‚úì</p>\n  </div>\n</div>\n```\n\n## The \"Small Multiples\" Narrative\n\nUse Tufte's small multiples to tell a comparative story.\n\n```typescript\n<div className=\"grid grid-cols-3 gap-4\">\n  {regions.map(region => (\n    <div key={region} className=\"region-card\">\n      <h4>{region}</h4>\n      <Sparkline data={salesByRegion[region]} />\n      <p className=\"insight\">\n        {generateInsight(salesByRegion[region])}\n      </p>\n    </div>\n  ))}\n</div>\n```\n\n**Insight Generation:**\n```typescript\nconst generateInsight = (data: DataPoint[]) => {\n  const trend = calculateTrend(data);\n  const peak = findPeak(data);\n\n  if (trend > 20) return `Strong growth (+${trend}%)`;\n  if (trend < -20) return `Declining (${trend}%)`;\n  if (peak.recent) return `Recent peak in ${peak.month}`;\n\n  return `Stable performance`;\n};\n```\n\n## Color as Narrative Device\n\nUse color to reinforce your story.\n\n### Semantic Colors\n\n```typescript\nconst colors = {\n  good: '#059669',      // Green for positive\n  bad: '#dc2626',       // Red for negative\n  neutral: '#6b7280',   // Gray for context\n  highlight: '#d97706'  // Orange for focus\n};\n\n// Highlight the important bar\n<BarChart\n  data={data}\n  colors={data.map(d =>\n    d.category === 'Mobile' ? colors.highlight : colors.neutral\n  )}\n/>\n```\n\n### Diverging Color Scales\n\nShow \"better than\" vs \"worse than\" with diverging colors.\n\n```typescript\n<Heatmap\n  data={performance}\n  colorScale={{\n    type: 'diverging',\n    domain: [-100, 0, 100],\n    colors: ['#dc2626', '#f3f4f6', '#059669']\n  }}\n/>\n```\n\n## Interactive Storytelling\n\nLet users explore the data themselves.\n\n### Filters That Tell Stories\n\n```typescript\nconst [selectedCategory, setSelectedCategory] = useState<string | null>(null);\n\n<div className=\"interactive-story\">\n  <h2>Explore Sales by Category</h2>\n\n  <div className=\"filters\">\n    {categories.map(cat => (\n      <button\n        key={cat}\n        onClick={() => setSelectedCategory(cat)}\n        className={selectedCategory === cat ? 'active' : ''}\n      >\n        {cat}\n      </button>\n    ))}\n  </div>\n\n  <AnimatePresence mode=\"wait\">\n    <motion.div\n      key={selectedCategory || 'all'}\n      initial={{ opacity: 0, x: 20 }}\n      animate={{ opacity: 1, x: 0 }}\n      exit={{ opacity: 0, x: -20 }}\n    >\n      <LineChart\n        data={filterData(data, selectedCategory)}\n      />\n      <Insight category={selectedCategory} />\n    </motion.div>\n  </AnimatePresence>\n</div>\n```\n\n### Tooltips as Micro-Stories\n\n```typescript\n<Tooltip\n  content={\n    <div className=\"tooltip-story\">\n      <h4>{dataPoint.label}</h4>\n      <p className=\"value\">${dataPoint.value.toLocaleString()}</p>\n      <p className=\"comparison\">\n        {dataPoint.changePercent > 0 ? '‚Üë' : '‚Üì'}\n        {Math.abs(dataPoint.changePercent)}% vs last period\n      </p>\n      <p className=\"insight\">{dataPoint.insight}</p>\n    </div>\n  }\n/>\n```\n\n## The Dashboard as a Story\n\nArrange dashboard widgets to tell a story from top to bottom.\n\n### Story Structure for Dashboards\n\n```typescript\n<div className=\"dashboard\">\n  {/* 1. HOOK - Most important insight */}\n  <section className=\"hero-insight\">\n    <h1>Revenue Up 32% This Quarter</h1>\n    <BigNumber value={revenue} change={+32} />\n  </section>\n\n  {/* 2. CONTEXT - What's driving this? */}\n  <section className=\"drivers\">\n    <h2>Growth Drivers</h2>\n    <div className=\"grid grid-cols-3 gap-4\">\n      <InsightCard title=\"Mobile Sales\" change={+68} />\n      <InsightCard title=\"New Customers\" change={+45} />\n      <InsightCard title=\"Avg Order Value\" change={+12} />\n    </div>\n  </section>\n\n  {/* 3. EVIDENCE - Detailed charts */}\n  <section className=\"details\">\n    <h2>Detailed Performance</h2>\n    <LineChart data={revenueOverTime} />\n    <BarChart data={revenueByChannel} />\n  </section>\n\n  {/* 4. CONCLUSION - What's next? */}\n  <section className=\"action-items\">\n    <h2>Recommended Actions</h2>\n    <ActionCard priority=\"high\">\n      Optimize mobile checkout (60% of traffic)\n    </ActionCard>\n    <ActionCard priority=\"medium\">\n      Expand successful campaigns to new regions\n    </ActionCard>\n  </section>\n</div>\n```\n\n## Narrative Voice: Writing for Data Viz\n\n### Active Voice > Passive Voice\n\n**‚ùå Passive:**\n> \"A 45% increase in mobile traffic was observed.\"\n\n**‚úÖ Active:**\n> \"Mobile traffic increased 45%.\"\n\n### Specific > Vague\n\n**‚ùå Vague:**\n> \"Sales improved significantly.\"\n\n**‚úÖ Specific:**\n> \"Sales increased 32%, from $1.8M to $2.4M.\"\n\n### Implications > Just Facts\n\n**‚ùå Just Facts:**\n> \"Desktop traffic decreased 20%.\"\n\n**‚úÖ With Implications:**\n> \"Desktop traffic decreased 20%, signaling a need to prioritize mobile UX investments.\"\n\n## AI-Enhanced Storytelling\n\nUse Claude Haiku to generate dynamic insights.\n\n```typescript\nconst generateInsight = async (data: DataPoint[]) => {\n  const response = await fetch('/api/claude', {\n    method: 'POST',\n    body: JSON.stringify({\n      model: 'claude-haiku',\n      prompt: `\n        Analyze this sales data and provide ONE key insight (max 20 words).\n        Be specific with numbers. Suggest one action.\n\n        Data: ${JSON.stringify(data)}\n      `\n    })\n  });\n\n  return response.text();\n  // Example output: \"Mobile sales surged 68% to $1.4M. Optimize mobile checkout to capitalize on this trend.\"\n};\n```\n\n## Case Study: NYT \"How the Pandemic Reshaped the Economy\"\n\nThe New York Times' COVID economic impact story exemplifies data storytelling:\n\n1. **Hook:** \"The pandemic upended the economy overnight.\"\n2. **Scrollytelling:** Charts animate as you scroll through narrative\n3. **Annotations:** Key dates labeled (lockdowns, stimulus, reopening)\n4. **Small multiples:** Compare different industries side-by-side\n5. **Interactive filters:** Explore by sector, region, demographic\n6. **Conclusion:** \"Recovery is uneven‚Äîservice workers still struggling\"\n\n### Implementation Pattern\n\n```typescript\n<ScrollytellingStory>\n  <Section>\n    <Narrative>\n      <h2>The pandemic upended the economy overnight.</h2>\n      <p>In March 2020, unemployment spiked faster than any recession in history.</p>\n    </Narrative>\n    <Chart>\n      <LineChart\n        data={unemployment}\n        highlightRange={['2020-03', '2020-04']}\n        annotation=\"33M jobs lost in 2 months\"\n      />\n    </Chart>\n  </Section>\n\n  <Section>\n    <Narrative>\n      <h2>Tech workers recovered quickly...</h2>\n      <p>By Q3 2020, tech sector employment returned to pre-pandemic levels.</p>\n    </Narrative>\n    <Chart>\n      <LineChart\n        data={techEmployment}\n        compareBaseline=\"2020-02\"\n      />\n    </Chart>\n  </Section>\n\n  <Section>\n    <Narrative>\n      <h2>...but service workers are still behind.</h2>\n      <p>Restaurant and hospitality jobs remain 15% below pre-pandemic levels.</p>\n    </Narrative>\n    <Chart>\n      <LineChart\n        data={serviceEmployment}\n        highlightGap=\"15% below baseline\"\n      />\n    </Chart>\n  </Section>\n</ScrollytellingStory>\n```\n\n## Accessibility in Data Stories\n\n### Provide Text Alternatives\n\n```typescript\n<figure>\n  <Chart data={data} />\n\n  <figcaption className=\"sr-only\">\n    {generateTextDescription(data)}\n  </figcaption>\n</figure>\n```\n\n### Generate Accessible Descriptions\n\n```typescript\nconst generateTextDescription = (data: DataPoint[]) => {\n  const trend = calculateTrend(data);\n  const max = Math.max(...data.map(d => d.value));\n  const maxMonth = data.find(d => d.value === max)?.month;\n\n  return `\n    Line chart showing ${data.length} months of sales data.\n    Overall trend is ${trend > 0 ? 'increasing' : 'decreasing'} by ${Math.abs(trend)}%.\n    Peak occurred in ${maxMonth} with ${max.toLocaleString()} sales.\n  `;\n};\n```\n\n## Checklist: Is Your Chart Telling a Story?\n\n- [ ] **Clear headline** - Insight stated upfront, not buried\n- [ ] **Context provided** - Why should we care?\n- [ ] **Key points annotated** - Don't make users hunt\n- [ ] **Comparison included** - Better than what? Worse than when?\n- [ ] **Action suggested** - So what should we do?\n- [ ] **Accessible** - Text alternative for screen readers\n- [ ] **Tested** - Real users understand the story\n\n## Resources\n\n- [The Pudding](https://pudding.cool/) - Masters of visual storytelling\n- [FlowingData](https://flowingdata.com/) - Narrative-driven data viz\n- [NYT Graphics](https://twitter.com/nytgraphics) - Industry standard\n- [Observable](https://observablehq.com/@observablehq/explore-featured-collections) - Interactive data stories\n\n## Summary\n\nData storytelling transforms charts from \"here's data\" to \"here's what it means and what we should do.\"\n\n**The Formula:**\n1. Lead with the insight\n2. Provide context\n3. Show evidence (the chart)\n4. Suggest action\n\n**The Tools:**\n- Annotations to guide the eye\n- Color to reinforce meaning\n- Progressive disclosure to manage complexity\n- Scrollytelling for narrative arc\n- Micro-interactions for engagement\n\n**Remember:** Your job isn't to show data. It's to change minds.\n"
        },
        {
          "name": "library-comparison.md",
          "type": "file",
          "path": "data-viz-2025/references/library-comparison.md",
          "size": 18890,
          "content": "# React Data Visualization Libraries: Comprehensive Comparison (2025)\n\nA deep dive into the top 5 data visualization libraries for React/Next.js/TypeScript applications.\n\n## Executive Summary\n\n| Library | Best For | Bundle Size | Learning Curve | TypeScript | SSR Support |\n|---------|----------|-------------|----------------|------------|-------------|\n| **Observable Plot** | Exploratory analysis, notebooks | üì¶ ~180KB | ‚ö° Low | ‚úÖ Excellent | ‚ö†Ô∏è Partial |\n| **Recharts** | Standard business charts | üì¶ ~380KB | ‚ö°‚ö° Very Low | ‚úÖ Built-in | ‚úÖ Yes |\n| **Nivo** | Beautiful, themed dashboards | üì¶ ~420KB | ‚ö°‚ö° Low | ‚úÖ Good | ‚úÖ Yes (unique!) |\n| **Visx** | Custom, bespoke visualizations | üì¶ ~450KB | ‚ö°‚ö°‚ö° Medium | ‚úÖ Excellent | ‚úÖ Yes |\n| **D3.js** | Maximum control & flexibility | üì¶ ~240KB | ‚ö°‚ö°‚ö°‚ö° High | ‚ö†Ô∏è Requires @types | ‚ö†Ô∏è Complex |\n\n## Observable Plot\n\n**What it is:** A JavaScript library for exploratory data visualization implementing a layered grammar of graphics (inspired by ggplot2, Vega-Lite).\n\n**Created by:** Observable (the team behind D3.js)\n\n**Philosophy:** Plot doesn't have \"chart types.\" Instead, it has geometric marks (bars, dots, lines, areas) that you compose with scales and transforms.\n\n### Strengths\n\n- **Fastest prototyping** - Make 50 charts in an hour to find the right one\n- **Declarative syntax** - Describe what you want, not how to draw it\n- **Powerful transforms** - Built-in binning, grouping, stacking, dodging\n- **Excellent for notebooks** - Perfect for Observable, Jupyter, or local experiments\n- **Highly composable** - Mix marks, facets, and annotations easily\n\n### Weaknesses\n\n- **Less React-friendly** - Requires `useEffect` + `useRef` pattern\n- **Newer library** - Smaller community than Recharts\n- **Limited theming** - Less control over styling than Nivo\n- **SSR requires workarounds** - Use `document` option for React SSR\n\n### When to Choose Observable Plot\n\n‚úÖ You're doing exploratory data analysis\n‚úÖ You want a ggplot2-like experience in JavaScript\n‚úÖ You're prototyping 10 different chart styles quickly\n‚úÖ You're working in Observable notebooks\n‚ùå You need pixel-perfect custom styling\n‚ùå You're building a production dashboard with complex theming\n\n### Code Example\n\n```typescript\nimport * as Plot from \"@observablehq/plot\";\nimport { useEffect, useRef } from \"react\";\n\nexport function SalesChart({ data }) {\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (!data || !containerRef.current) return;\n\n    const plot = Plot.plot({\n      marks: [\n        Plot.lineY(data, { x: \"date\", y: \"sales\", stroke: \"#d97706\" }),\n        Plot.ruleY([0])\n      ],\n      width: 640,\n      height: 400,\n      marginLeft: 50\n    });\n\n    containerRef.current.append(plot);\n    return () => plot.remove();\n  }, [data]);\n\n  return <div ref={containerRef} />;\n}\n```\n\n### Best Resources\n\n- [Official Documentation](https://observablehq.com/plot/)\n- [Observable Plot Gallery](https://observablehq.com/@observablehq/plot-gallery)\n- [React Integration Guide](https://observablehq.com/@anjana/interactive-data-viz-in-react)\n\n## Recharts\n\n**What it is:** A composable charting library built with React and D3. The most popular React charting library (24.8K GitHub stars).\n\n**Created by:** Community-driven open source project\n\n**Philosophy:** Everything is a React component. Build charts by composing `<LineChart>`, `<XAxis>`, `<Tooltip>`, etc.\n\n### Strengths\n\n- **Easiest learning curve** - If you know React, you know Recharts\n- **Excellent documentation** - Clear examples, interactive playground\n- **Huge community** - Most questions already answered on StackOverflow\n- **TypeScript first-class** - Built-in types, excellent IDE support\n- **Responsive by default** - `<ResponsiveContainer>` handles sizing\n- **Batteries included** - Tooltips, legends, animations out of the box\n\n### Weaknesses\n\n- **SVG only** - No Canvas option for large datasets (>1000 points)\n- **Limited mobile gestures** - No built-in swipe/pinch support\n- **Styling can be verbose** - Many props to customize appearance\n- **Bundle size** - Larger than Plot, though still reasonable\n\n### When to Choose Recharts\n\n‚úÖ You want the simplest React integration\n‚úÖ You're building standard business charts (bars, lines, areas, pies)\n‚úÖ You need excellent documentation and community support\n‚úÖ You're new to data visualization libraries\n‚úÖ You prioritize developer experience over visual polish\n‚ùå You need Canvas rendering for huge datasets\n‚ùå You want stunning defaults without customization\n\n### Code Example\n\n```typescript\nimport {\n  LineChart,\n  Line,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer\n} from 'recharts';\n\nexport function SalesChart({ data }) {\n  return (\n    <ResponsiveContainer width=\"100%\" height={400}>\n      <LineChart data={data}>\n        <CartesianGrid strokeDasharray=\"3 3\" opacity={0.1} />\n        <XAxis dataKey=\"date\" />\n        <YAxis />\n        <Tooltip />\n        <Line\n          type=\"monotone\"\n          dataKey=\"sales\"\n          stroke=\"#d97706\"\n          strokeWidth={2}\n        />\n      </LineChart>\n    </ResponsiveContainer>\n  );\n}\n```\n\n### Best Resources\n\n- [Official Documentation](https://recharts.org/)\n- [Examples Gallery](https://recharts.org/en-US/examples)\n- [TypeScript Guide](https://recharts.org/en-US/guide/typescript)\n\n## Nivo\n\n**What it is:** A React charting library providing rich components with beautiful defaults, themes, and animations.\n\n**Created by:** Rapha√´l Benitte\n\n**Philosophy:** Beauty and flexibility out of the box. Extensive props for customization, but sensible defaults look great.\n\n### Strengths\n\n- **Gorgeous defaults** - Best-looking charts without customization\n- **Multiple rendering modes** - SVG, Canvas, or HTML\n- **Server-side rendering** - Unique feature! Generate charts on the server\n- **HTTP rendering API** - Generate chart images via API calls\n- **Extensive chart types** - 20+ chart types including advanced ones\n- **Motion/animations** - Smooth transitions powered by React Spring\n- **Storybook integration** - Interactive component playground\n\n### Weaknesses\n\n- **Larger bundle size** - Most features = more bytes\n- **Different API style** - Single component with many props (not composable like Recharts)\n- **Can feel heavyweight** - Overkill for simple charts\n- **Learning curve** - Many props to understand\n\n### When to Choose Nivo\n\n‚úÖ You want visually stunning charts immediately\n‚úÖ You need server-side rendering support\n‚úÖ You're building a dashboard with consistent theming\n‚úÖ You need both SVG and Canvas rendering options\n‚úÖ You want advanced chart types (Sankey, Chord, Network)\n‚ùå Bundle size is critical (use Recharts instead)\n‚ùå You prefer composable API (use Recharts instead)\n\n### Code Example\n\n```typescript\nimport { ResponsiveLine } from '@nivo/line';\n\nexport function SalesChart({ data }) {\n  // Nivo expects different data format\n  const nivoData = [\n    {\n      id: \"sales\",\n      data: data.map(d => ({ x: d.date, y: d.sales }))\n    }\n  ];\n\n  return (\n    <div style={{ height: 400 }}>\n      <ResponsiveLine\n        data={nivoData}\n        margin={{ top: 50, right: 110, bottom: 50, left: 60 }}\n        xScale={{ type: 'point' }}\n        yScale={{ type: 'linear', min: 'auto', max: 'auto' }}\n        curve=\"monotoneX\"\n        axisBottom={{\n          tickRotation: 0,\n          legend: 'Date',\n          legendOffset: 36\n        }}\n        axisLeft={{\n          tickRotation: 0,\n          legend: 'Sales',\n          legendOffset: -40\n        }}\n        colors=\"#d97706\"\n        pointSize={8}\n        pointColor=\"#fff\"\n        pointBorderWidth={2}\n        pointBorderColor={{ from: 'serieColor' }}\n        enableGridX={false}\n        enableGridY={true}\n        useMesh={true}\n        theme={{\n          axis: {\n            ticks: {\n              line: { stroke: '#e5e7eb' },\n              text: { fill: '#6b7280' }\n            }\n          },\n          grid: {\n            line: { stroke: '#f3f4f6', strokeWidth: 1 }\n          }\n        }}\n      />\n    </div>\n  );\n}\n```\n\n### Best Resources\n\n- [Official Documentation](https://nivo.rocks/)\n- [Component Playground](https://nivo.rocks/components/) - Interactive prop tweaking\n- [Storybook](https://nivo.rocks/storybook/)\n\n## Visx\n\n**What it is:** A collection of low-level visualization primitives for React (created by Airbnb).\n\n**Created by:** Airbnb\n\n**Philosophy:** Provide React components for D3 primitives (scales, axes, shapes) but let you compose them however you want.\n\n### Strengths\n\n- **Maximum flexibility** - Build exactly what you need\n- **React patterns** - Hooks, composition, props (not D3's imperative style)\n- **Modular** - Import only what you need, tree-shake aggressively\n- **Performance** - Low-level control for optimization\n- **Great for custom viz** - When standard charts aren't enough\n- **Excellent TypeScript** - First-class types throughout\n\n### Weaknesses\n\n- **More code required** - No pre-built chart components\n- **Steeper learning curve** - Must understand both D3 concepts and React\n- **Less documentation** - Fewer examples than Recharts/Nivo\n- **Bare-bones defaults** - You build everything from scratch\n\n### When to Choose Visx\n\n‚úÖ You're building a unique, custom visualization\n‚úÖ You need fine-grained control over every pixel\n‚úÖ You want React patterns, not D3's imperative approach\n‚úÖ You're comfortable with D3 concepts (scales, generators, etc.)\n‚úÖ Performance optimization is critical\n‚ùå You want pre-built chart components\n‚ùå You're new to data visualization\n\n### Code Example\n\n```typescript\nimport { Group } from '@visx/group';\nimport { LinePath } from '@visx/shape';\nimport { scaleTime, scaleLinear } from '@visx/scale';\nimport { AxisBottom, AxisLeft } from '@visx/axis';\nimport { GridRows } from '@visx/grid';\n\nexport function SalesChart({ data, width = 640, height = 400 }) {\n  const margin = { top: 20, right: 20, bottom: 40, left: 50 };\n  const xMax = width - margin.left - margin.right;\n  const yMax = height - margin.top - margin.bottom;\n\n  const xScale = scaleTime({\n    domain: [Math.min(...data.map(d => d.date)), Math.max(...data.map(d => d.date))],\n    range: [0, xMax]\n  });\n\n  const yScale = scaleLinear({\n    domain: [0, Math.max(...data.map(d => d.sales))],\n    range: [yMax, 0],\n    nice: true\n  });\n\n  return (\n    <svg width={width} height={height}>\n      <Group left={margin.left} top={margin.top}>\n        <GridRows scale={yScale} width={xMax} stroke=\"#f3f4f6\" />\n        <AxisBottom top={yMax} scale={xScale} />\n        <AxisLeft scale={yScale} />\n        <LinePath\n          data={data}\n          x={d => xScale(d.date)}\n          y={d => yScale(d.sales)}\n          stroke=\"#d97706\"\n          strokeWidth={2}\n        />\n      </Group>\n    </svg>\n  );\n}\n```\n\n### Best Resources\n\n- [Official Documentation](https://airbnb.io/visx/)\n- [Gallery](https://airbnb.io/visx/gallery)\n- [GitHub Examples](https://github.com/airbnb/visx/tree/master/packages/visx-demo/src/sandboxes)\n\n## D3.js\n\n**What it is:** The foundational data visualization library for the web. Everything else is built on top of D3.\n\n**Created by:** Mike Bostock (now maintains Observable)\n\n**Philosophy:** Data-driven documents. Bind data to DOM elements, apply transformations, handle updates.\n\n### Strengths\n\n- **Unlimited power** - Can build literally anything\n- **Industry standard** - Most examples, tutorials, and resources\n- **Mature ecosystem** - 14+ years of development\n- **Modular** - Use just what you need (d3-scale, d3-shape, etc.)\n- **Smaller bundle** - Importing only needed modules keeps size down\n- **Advanced features** - Force simulations, geo projections, hierarchies\n\n### Weaknesses\n\n- **Steepest learning curve** - Imperative API, different mental model\n- **Not React-friendly** - Direct DOM manipulation conflicts with React\n- **Verbose** - More code for simple charts\n- **Requires workarounds** - Need `useEffect` + `useRef` in React\n- **TypeScript requires extra work** - Must install `@types/d3`\n\n### When to Choose D3.js\n\n‚úÖ You need maximum control and flexibility\n‚úÖ You're building something completely custom\n‚úÖ You're already comfortable with D3\n‚úÖ You need advanced features (force-directed graphs, geo maps)\n‚úÖ You want the smallest possible bundle (cherry-pick modules)\n‚ùå You're new to data visualization\n‚ùå You want React-friendly components\n‚ùå You need something working quickly\n\n### Code Example\n\n```typescript\nimport * as d3 from 'd3';\nimport { useEffect, useRef } from 'react';\n\nexport function SalesChart({ data }) {\n  const svgRef = useRef<SVGSVGElement>(null);\n\n  useEffect(() => {\n    if (!data || !svgRef.current) return;\n\n    const svg = d3.select(svgRef.current);\n    const margin = { top: 20, right: 20, bottom: 40, left: 50 };\n    const width = 640 - margin.left - margin.right;\n    const height = 400 - margin.top - margin.bottom;\n\n    svg.selectAll(\"*\").remove(); // Clear previous render\n\n    const g = svg\n      .append(\"g\")\n      .attr(\"transform\", `translate(${margin.left},${margin.top})`);\n\n    const x = d3.scaleTime()\n      .domain(d3.extent(data, d => d.date) as [Date, Date])\n      .range([0, width]);\n\n    const y = d3.scaleLinear()\n      .domain([0, d3.max(data, d => d.sales) as number])\n      .range([height, 0]);\n\n    const line = d3.line<DataPoint>()\n      .x(d => x(d.date))\n      .y(d => y(d.sales))\n      .curve(d3.curveMonotoneX);\n\n    g.append(\"g\")\n      .attr(\"transform\", `translate(0,${height})`)\n      .call(d3.axisBottom(x));\n\n    g.append(\"g\")\n      .call(d3.axisLeft(y));\n\n    g.append(\"path\")\n      .datum(data)\n      .attr(\"fill\", \"none\")\n      .attr(\"stroke\", \"#d97706\")\n      .attr(\"stroke-width\", 2)\n      .attr(\"d\", line);\n\n  }, [data]);\n\n  return <svg ref={svgRef} width={640} height={400} />;\n}\n```\n\n### Best Resources\n\n- [Official Documentation](https://d3js.org/)\n- [Observable Gallery](https://observablehq.com/@d3/gallery)\n- [D3 Graph Gallery](https://d3-graph-gallery.com/)\n\n## Comparison Matrix\n\n### Performance\n\n| Library | Small Dataset (<100) | Medium (100-1K) | Large (1K-10K) | Huge (>10K) |\n|---------|---------------------|-----------------|----------------|-------------|\n| Observable Plot | ‚ö°‚ö°‚ö° | ‚ö°‚ö°‚ö° | ‚ö°‚ö° | ‚ö° |\n| Recharts | ‚ö°‚ö°‚ö° | ‚ö°‚ö° | ‚ö° | ‚ùå (SVG only) |\n| Nivo | ‚ö°‚ö°‚ö° | ‚ö°‚ö°‚ö° | ‚ö°‚ö° (Canvas) | ‚ö° (Canvas) |\n| Visx | ‚ö°‚ö°‚ö° | ‚ö°‚ö°‚ö° | ‚ö°‚ö° | ‚ö° (with optimization) |\n| D3.js | ‚ö°‚ö°‚ö° | ‚ö°‚ö°‚ö° | ‚ö°‚ö°‚ö° (Canvas) | ‚ö°‚ö° (WebGL possible) |\n\n### Feature Comparison\n\n| Feature | Observable Plot | Recharts | Nivo | Visx | D3.js |\n|---------|----------------|----------|------|------|-------|\n| **React Integration** | Manual | Native | Native | Native | Manual |\n| **TypeScript** | ‚úÖ Built-in | ‚úÖ Built-in | ‚úÖ Built-in | ‚úÖ Built-in | ‚ö†Ô∏è Requires @types |\n| **SSR Support** | ‚ö†Ô∏è Workaround | ‚úÖ Yes | ‚úÖ Yes (unique!) | ‚úÖ Yes | ‚ö†Ô∏è Complex |\n| **Responsive** | Manual | ‚úÖ Easy | ‚úÖ Easy | ‚úÖ Easy | Manual |\n| **Animations** | Limited | ‚úÖ Built-in | ‚úÖ Excellent | Manual | ‚úÖ Transitions |\n| **Tooltips** | Manual | ‚úÖ Built-in | ‚úÖ Built-in | Manual | Manual |\n| **Themes** | Limited | ‚ö†Ô∏è Via props | ‚úÖ Excellent | Manual | Manual |\n| **Canvas Rendering** | ‚ùå No | ‚ùå No | ‚úÖ Yes | ‚úÖ Manual | ‚úÖ Yes |\n| **Accessibility** | Manual | ‚ö†Ô∏è Basic | ‚ö†Ô∏è Basic | Manual | Manual |\n\n### Chart Types Support\n\n| Chart Type | Observable Plot | Recharts | Nivo | Visx | D3.js |\n|------------|----------------|----------|------|------|-------|\n| **Bar** | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |\n| **Line** | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |\n| **Area** | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |\n| **Pie/Donut** | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |\n| **Scatter** | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |\n| **Heatmap** | ‚úÖ | ‚ùå | ‚úÖ | ‚úÖ | ‚úÖ |\n| **Sankey** | ‚ùå | ‚ùå | ‚úÖ | ‚úÖ | ‚úÖ |\n| **Chord** | ‚ùå | ‚ùå | ‚úÖ | ‚úÖ | ‚úÖ |\n| **Network** | ‚ùå | ‚ùå | ‚úÖ | ‚úÖ | ‚úÖ |\n| **Treemap** | ‚ùå | ‚ùå | ‚úÖ | ‚úÖ | ‚úÖ |\n| **Sunburst** | ‚ùå | ‚ùå | ‚úÖ | ‚úÖ | ‚úÖ |\n| **Calendar** | ‚ùå | ‚ùå | ‚úÖ | ‚úÖ | ‚úÖ |\n\n## Decision Framework\n\n### Use Observable Plot when:\n- üî¨ Doing exploratory data analysis\n- üìä Need to prototype 10+ chart variations quickly\n- üéì Prefer grammar-of-graphics (ggplot2-style)\n- üìì Working in notebooks (Observable, Jupyter)\n\n### Use Recharts when:\n- üöÄ Want fastest time to first chart\n- üì± Building responsive business dashboards\n- üë• Large team needs simple, well-documented library\n- üéØ Standard chart types are sufficient\n- üíö New to data visualization\n\n### Use Nivo when:\n- üé® Visual polish is critical\n- üñ•Ô∏è Need server-side rendering\n- üé≠ Building themed dashboards\n- üìä Need advanced chart types (Sankey, Chord)\n- üé¨ Want smooth animations out of the box\n\n### Use Visx when:\n- üéØ Building custom, unique visualizations\n- ‚öôÔ∏è Need fine-grained control\n- üèóÔ∏è Prefer React patterns over D3 imperative style\n- üì¶ Want modular, tree-shakeable imports\n- ‚ö° Performance optimization is critical\n\n### Use D3.js when:\n- üîì Need maximum control and flexibility\n- üé® Building completely novel visualizations\n- üåç Need advanced features (force, geo, hierarchy)\n- üìö Already comfortable with D3\n- üíé Want smallest possible bundle (cherry-pick modules)\n\n## Hybrid Approaches\n\nYou don't have to choose just one library. Mix and match:\n\n### Recharts + D3 Scales\n```typescript\nimport { scaleLog } from 'd3-scale';\nimport { LineChart, Line, YAxis } from 'recharts';\n\n// Use D3's log scale with Recharts\nconst logScale = scaleLog().domain([1, 1000000]).range([0, 400]);\n\n<LineChart data={data}>\n  <YAxis scale={logScale} />\n  <Line dataKey=\"value\" />\n</LineChart>\n```\n\n### Nivo + Custom SVG\n```typescript\nimport { ResponsiveLine } from '@nivo/line';\n\n<ResponsiveLine\n  data={data}\n  layers={[\n    'grid',\n    'markers',\n    'axes',\n    'areas',\n    'lines',\n    'points',\n    ({ innerWidth, innerHeight }) => (\n      // Custom SVG layer\n      <circle cx={innerWidth / 2} cy={innerHeight / 2} r={20} fill=\"red\" />\n    )\n  ]}\n/>\n```\n\n## Sources\n\n- [Nivo vs Recharts Comparison | Speakeasy](https://www.speakeasy.com/blog/nivo-vs-recharts)\n- [Best React Chart Libraries 2025 | Creole Studios](https://www.creolestudios.com/top-react-chart-libraries/)\n- [Comparison of Data Visualization Libraries for React | Capital One](https://www.capitalone.com/tech/software-engineering/comparison-data-visualization-libraries-for-react/)\n- [Best React Chart Libraries 2025 | Embeddable](https://embeddable.com/blog/react-chart-libraries)\n- [Best React Chart Libraries 2025 | LogRocket](https://blog.logrocket.com/best-react-chart-libraries-2025/)\n- [Observable Plot Documentation](https://observablehq.com/plot/)\n- [Observable's 2025 Year in Review](https://observablehq.com/blog/observable-2025-year-in-review)\n"
        },
        {
          "name": "testing-strategies.md",
          "type": "file",
          "path": "data-viz-2025/references/testing-strategies.md",
          "size": 16557,
          "content": "# Testing Data Visualizations: Comprehensive Strategies\n\nData visualizations are notoriously difficult to test. They combine visual appearance, data accuracy, interactivity, and accessibility. This guide covers all testing approaches.\n\n## Testing Philosophy\n\n### Three Dimensions of Testing\n\n1. **Data Accuracy** - Does the chart represent data correctly?\n2. **Visual Appearance** - Does it look right? (Regression testing)\n3. **Interaction & Accessibility** - Can users interact with it? Is it accessible?\n\n### The Testing Pyramid for Data Viz\n\n```\n        /\\\n       /  \\      E2E Visual Tests (Percy, Chromatic)\n      /‚îÄ‚îÄ‚îÄ‚îÄ\\     ‚Üê Expensive, slow, comprehensive\n     /      \\\n    / Unit & \\   Component + Integration Tests\n   / Component\\  ‚Üê Fast, focused, data accuracy\n  /‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\\\n /              \\ Property-based & Snapshot Tests\n/________________\\ ‚Üê Cheapest, fastest, catches regressions\n```\n\n## 1. Data Accuracy Testing\n\n### Verify Rendered Elements Match Data\n\n```typescript\nimport { render, screen } from '@testing-library/react';\nimport { BarChart } from './BarChart';\n\ndescribe('BarChart - Data Accuracy', () => {\n  const mockData = [\n    { category: 'A', value: 10 },\n    { category: 'B', value: 20 },\n    { category: 'C', value: 15 }\n  ];\n\n  test('renders correct number of bars', () => {\n    render(<BarChart data={mockData} />);\n\n    const bars = screen.getAllByTestId('bar');\n    expect(bars).toHaveLength(3);\n  });\n\n  test('bar heights are proportional to values', () => {\n    render(<BarChart data={mockData} />);\n\n    const bars = screen.getAllByTestId('bar');\n    const heights = bars.map(b =>\n      parseInt(b.getAttribute('height') || '0')\n    );\n\n    // B should be 2x A (20 vs 10)\n    expect(heights[1]).toBe(heights[0] * 2);\n\n    // C should be 1.5x A (15 vs 10)\n    expect(heights[2]).toBe(heights[0] * 1.5);\n  });\n\n  test('labels match data categories', () => {\n    render(<BarChart data={mockData} />);\n\n    expect(screen.getByText('A')).toBeInTheDocument();\n    expect(screen.getByText('B')).toBeInTheDocument();\n    expect(screen.getByText('C')).toBeInTheDocument();\n  });\n});\n```\n\n### Test Scale Calculations\n\n```typescript\ndescribe('BarChart - Scale Accuracy', () => {\n  test('y-axis scale is correct', () => {\n    const data = [\n      { x: 'A', y: 0 },\n      { x: 'B', y: 50 },\n      { x: 'C', y: 100 }\n    ];\n\n    render(<BarChart data={data} height={200} />);\n\n    const bars = screen.getAllByTestId('bar');\n\n    // First bar (y=0) should be at bottom (height 200)\n    expect(bars[0].getAttribute('y')).toBe('200');\n\n    // Middle bar (y=50) should be at middle (height 100)\n    expect(bars[1].getAttribute('y')).toBe('100');\n\n    // Last bar (y=100) should be at top (height 0)\n    expect(bars[2].getAttribute('y')).toBe('0');\n  });\n});\n```\n\n### Test Edge Cases\n\n```typescript\ndescribe('BarChart - Edge Cases', () => {\n  test('handles empty data gracefully', () => {\n    render(<BarChart data={[]} />);\n    expect(screen.getByText(/no data/i)).toBeInTheDocument();\n  });\n\n  test('handles single data point', () => {\n    render(<BarChart data={[{ x: 'A', y: 10 }]} />);\n    const bars = screen.getAllByTestId('bar');\n    expect(bars).toHaveLength(1);\n  });\n\n  test('handles negative values', () => {\n    const data = [\n      { x: 'A', y: -10 },\n      { x: 'B', y: 20 }\n    ];\n    render(<BarChart data={data} />);\n\n    // Verify baseline is drawn at zero\n    expect(screen.getByTestId('baseline')).toBeInTheDocument();\n  });\n\n  test('handles very large values without overflow', () => {\n    const data = [{ x: 'A', y: 1000000 }];\n    render(<BarChart data={data} />);\n\n    const bar = screen.getByTestId('bar');\n    const height = parseInt(bar.getAttribute('height') || '0');\n\n    // Should fit within chart bounds\n    expect(height).toBeLessThanOrEqual(400);\n  });\n});\n```\n\n## 2. Visual Regression Testing\n\n### Percy (Recommended for Most Projects)\n\nPercy takes screenshots of your components and diffs them against baseline images.\n\n**Setup:**\n\n```bash\nnpm install --save-dev @percy/cli @percy/storybook\n```\n\n**Storybook Stories:**\n\n```typescript\n// BarChart.stories.tsx\nimport type { Meta, StoryObj } from '@storybook/react';\nimport { BarChart } from './BarChart';\n\nconst meta: Meta<typeof BarChart> = {\n  title: 'Charts/BarChart',\n  component: BarChart,\n  parameters: {\n    percy: {\n      skip: false,\n      widths: [375, 768, 1280] // Mobile, tablet, desktop\n    }\n  }\n};\n\nexport default meta;\ntype Story = StoryObj<typeof BarChart>;\n\nexport const Default: Story = {\n  args: {\n    data: [\n      { x: 'Jan', y: 10 },\n      { x: 'Feb', y: 20 },\n      { x: 'Mar', y: 15 }\n    ]\n  }\n};\n\nexport const Empty: Story = {\n  args: {\n    data: []\n  }\n};\n\nexport const LargeDataset: Story = {\n  args: {\n    data: Array.from({ length: 50 }, (_, i) => ({\n      x: `Item ${i}`,\n      y: Math.random() * 100\n    }))\n  }\n};\n\nexport const DarkMode: Story = {\n  args: {\n    data: [\n      { x: 'Jan', y: 10 },\n      { x: 'Feb', y: 20 }\n    ]\n  },\n  parameters: {\n    backgrounds: { default: 'dark' }\n  }\n};\n```\n\n**Run Percy:**\n\n```bash\n# Build Storybook\nnpm run build-storybook\n\n# Take snapshots\nnpx percy storybook ./storybook-static\n```\n\n**CI Integration (GitHub Actions):**\n\n```yaml\n# .github/workflows/visual-tests.yml\nname: Visual Tests\non: [pull_request]\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - uses: actions/setup-node@v3\n      - run: npm ci\n      - run: npm run build-storybook\n      - run: npx percy storybook ./storybook-static\n        env:\n          PERCY_TOKEN: ${{ secrets.PERCY_TOKEN }}\n```\n\n### Chromatic (Best for Storybook-First Teams)\n\nChromatic is built specifically for Storybook with tighter integration.\n\n**Setup:**\n\n```bash\nnpm install --save-dev chromatic\n```\n\n**Run:**\n\n```bash\nnpx chromatic --project-token=<your-token>\n```\n\n**Benefits over Percy:**\n- Automatic Storybook detection\n- Component-level testing\n- Interaction testing support\n- TurboSnap (only tests changed components)\n\n### Playwright Visual Comparisons (For E2E Tests)\n\n```typescript\n// chart.visual.spec.ts\nimport { test, expect } from '@playwright/test';\n\ntest('bar chart renders correctly', async ({ page }) => {\n  await page.goto('/charts/bar');\n\n  // Wait for chart to render\n  await page.waitForSelector('[data-testid=\"bar-chart\"]');\n\n  // Take screenshot\n  await expect(page).toHaveScreenshot('bar-chart-default.png', {\n    maxDiffPixels: 100 // Allow small differences\n  });\n});\n\ntest('chart updates on filter change', async ({ page }) => {\n  await page.goto('/dashboard');\n\n  // Initial state\n  await expect(page).toHaveScreenshot('chart-before-filter.png');\n\n  // Apply filter\n  await page.click('[data-testid=\"filter-button\"]');\n  await page.waitForTimeout(500); // Wait for animation\n\n  // After filter\n  await expect(page).toHaveScreenshot('chart-after-filter.png');\n});\n```\n\n## 3. Interaction Testing\n\n### User Interactions\n\n```typescript\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\n\ndescribe('BarChart - Interactions', () => {\n  test('shows tooltip on hover', async () => {\n    const user = userEvent.setup();\n    render(<BarChart data={mockData} />);\n\n    const bar = screen.getAllByTestId('bar')[0];\n\n    // Hover over bar\n    await user.hover(bar);\n\n    // Tooltip appears\n    await waitFor(() => {\n      expect(screen.getByRole('tooltip')).toBeInTheDocument();\n      expect(screen.getByText(/value: 10/i)).toBeInTheDocument();\n    });\n  });\n\n  test('hides tooltip on mouse leave', async () => {\n    const user = userEvent.setup();\n    render(<BarChart data={mockData} />);\n\n    const bar = screen.getAllByTestId('bar')[0];\n\n    await user.hover(bar);\n    await waitFor(() => expect(screen.getByRole('tooltip')).toBeInTheDocument());\n\n    await user.unhover(bar);\n    await waitFor(() => expect(screen.queryByRole('tooltip')).not.toBeInTheDocument());\n  });\n\n  test('calls onClick handler when bar is clicked', async () => {\n    const handleClick = jest.fn();\n    render(<BarChart data={mockData} onBarClick={handleClick} />);\n\n    const bar = screen.getAllByTestId('bar')[1];\n    fireEvent.click(bar);\n\n    expect(handleClick).toHaveBeenCalledWith(\n      expect.objectContaining({ category: 'B', value: 20 })\n    );\n  });\n});\n```\n\n### Keyboard Navigation\n\n```typescript\ndescribe('BarChart - Keyboard Navigation', () => {\n  test('bars are focusable via Tab key', async () => {\n    const user = userEvent.setup();\n    render(<BarChart data={mockData} />);\n\n    // Tab to first bar\n    await user.tab();\n    expect(screen.getAllByTestId('bar')[0]).toHaveFocus();\n\n    // Tab to second bar\n    await user.tab();\n    expect(screen.getAllByTestId('bar')[1]).toHaveFocus();\n  });\n\n  test('Enter key activates bar', async () => {\n    const user = userEvent.setup();\n    const handleClick = jest.fn();\n    render(<BarChart data={mockData} onBarClick={handleClick} />);\n\n    await user.tab(); // Focus first bar\n    await user.keyboard('{Enter}');\n\n    expect(handleClick).toHaveBeenCalledWith(\n      expect.objectContaining({ category: 'A', value: 10 })\n    );\n  });\n});\n```\n\n## 4. Accessibility Testing\n\n### Automated Accessibility Tests\n\n```typescript\nimport { render } from '@testing-library/react';\nimport { axe, toHaveNoViolations } from 'jest-axe';\n\nexpect.extend(toHaveNoViolations);\n\ndescribe('BarChart - Accessibility', () => {\n  test('has no axe violations', async () => {\n    const { container } = render(<BarChart data={mockData} />);\n    const results = await axe(container);\n    expect(results).toHaveNoViolations();\n  });\n\n  test('has proper ARIA labels', () => {\n    render(<BarChart data={mockData} title=\"Sales by Month\" />);\n\n    // Chart container has role\n    expect(screen.getByRole('img')).toBeInTheDocument();\n\n    // Title is associated\n    expect(screen.getByLabelText(/sales by month/i)).toBeInTheDocument();\n  });\n\n  test('provides text alternative for screen readers', () => {\n    render(<BarChart data={mockData} />);\n\n    // Data table alternative is available\n    expect(screen.getByRole('table', { hidden: true })).toBeInTheDocument();\n  });\n});\n```\n\n### Color Contrast Verification\n\n```typescript\ntest('meets color contrast requirements', () => {\n  render(<BarChart data={mockData} />);\n\n  const bar = screen.getAllByTestId('bar')[0];\n  const barColor = window.getComputedStyle(bar).fill;\n\n  // Use color-contrast library or manual calculation\n  const contrastRatio = calculateContrastRatio(barColor, '#ffffff');\n\n  // WCAG AA requires 3:1 for large text/graphics\n  expect(contrastRatio).toBeGreaterThanOrEqual(3);\n});\n```\n\n## 5. Performance Testing\n\n### Rendering Performance\n\n```typescript\ndescribe('BarChart - Performance', () => {\n  test('renders large dataset in < 500ms', () => {\n    const largeData = Array.from({ length: 1000 }, (_, i) => ({\n      x: `Item ${i}`,\n      y: Math.random() * 100\n    }));\n\n    const start = performance.now();\n    render(<BarChart data={largeData} />);\n    const end = performance.now();\n\n    expect(end - start).toBeLessThan(500);\n  });\n\n  test('does not re-render on unrelated prop changes', () => {\n    const { rerender } = render(\n      <BarChart data={mockData} unrelatedProp=\"value1\" />\n    );\n\n    const renderSpy = jest.spyOn(React, 'createElement');\n\n    // Change unrelated prop\n    rerender(<BarChart data={mockData} unrelatedProp=\"value2\" />);\n\n    // Chart should be memoized and not re-render\n    expect(renderSpy).toHaveBeenCalledTimes(0);\n  });\n});\n```\n\n### Memory Leak Detection\n\n```typescript\ntest('cleans up event listeners on unmount', () => {\n  const { unmount } = render(<BarChart data={mockData} />);\n\n  const initialListeners = getEventListeners(window).length;\n\n  unmount();\n\n  const finalListeners = getEventListeners(window).length;\n\n  // Should remove all listeners\n  expect(finalListeners).toBeLessThanOrEqual(initialListeners);\n});\n```\n\n## 6. Snapshot Testing\n\nUse snapshots to catch unintended changes in SVG output.\n\n```typescript\nimport { render } from '@testing-library/react';\n\ndescribe('BarChart - Snapshots', () => {\n  test('matches snapshot', () => {\n    const { container } = render(<BarChart data={mockData} />);\n    expect(container.firstChild).toMatchSnapshot();\n  });\n\n  test('matches snapshot with custom colors', () => {\n    const { container } = render(\n      <BarChart\n        data={mockData}\n        colors={['#d97706', '#7c3aed', '#059669']}\n      />\n    );\n    expect(container.firstChild).toMatchSnapshot();\n  });\n});\n```\n\n**Note:** Snapshots are brittle. Use sparingly and update intentionally.\n\n## 7. Cross-Browser Testing\n\n### BrowserStack/Sauce Labs\n\n```javascript\n// wdio.conf.js\nexports.config = {\n  services: ['browserstack'],\n  capabilities: [\n    {\n      browserName: 'chrome',\n      'bstack:options': {\n        os: 'Windows',\n        osVersion: '11'\n      }\n    },\n    {\n      browserName: 'safari',\n      'bstack:options': {\n        os: 'OS X',\n        osVersion: 'Ventura'\n      }\n    }\n  ],\n  specs: ['./test/charts/**/*.spec.ts']\n};\n```\n\n## 8. Property-Based Testing\n\nTest with randomly generated data to find edge cases.\n\n```typescript\nimport { fc } from 'fast-check';\n\ndescribe('BarChart - Property-Based Tests', () => {\n  test('handles any array of valid data points', () => {\n    fc.assert(\n      fc.property(\n        fc.array(\n          fc.record({\n            x: fc.string(),\n            y: fc.integer({ min: 0, max: 1000 })\n          }),\n          { minLength: 1, maxLength: 100 }\n        ),\n        (data) => {\n          const { container } = render(<BarChart data={data} />);\n\n          // Should render without crashing\n          expect(container.querySelector('svg')).toBeInTheDocument();\n\n          // Number of bars should match data length\n          const bars = container.querySelectorAll('[data-testid=\"bar\"]');\n          expect(bars.length).toBe(data.length);\n        }\n      )\n    );\n  });\n});\n```\n\n## Testing Checklist\n\nBefore shipping a chart component:\n\n### Data Accuracy\n- [ ] Correct number of elements rendered\n- [ ] Visual encoding proportional to data values\n- [ ] Labels match data\n- [ ] Scales are accurate\n- [ ] Edge cases handled (empty, single point, negatives, huge values)\n\n### Visual Appearance\n- [ ] Percy/Chromatic snapshots passing\n- [ ] Renders correctly on mobile, tablet, desktop\n- [ ] Dark mode support tested\n- [ ] Animations don't break visual tests\n\n### Interactions\n- [ ] Hover states work\n- [ ] Click handlers fire correctly\n- [ ] Keyboard navigation functional\n- [ ] Touch gestures work on mobile\n\n### Accessibility\n- [ ] No axe violations\n- [ ] Proper ARIA roles and labels\n- [ ] Keyboard accessible\n- [ ] Screen reader compatible\n- [ ] Color contrast ‚â•3:1\n- [ ] Respects prefers-reduced-motion\n- [ ] Provides data table alternative\n\n### Performance\n- [ ] Renders large datasets in <500ms\n- [ ] No unnecessary re-renders\n- [ ] No memory leaks\n- [ ] Bundle size reasonable\n\n### Cross-Browser\n- [ ] Works in Chrome, Firefox, Safari, Edge\n- [ ] Works on iOS Safari, Android Chrome\n- [ ] No console errors\n\n## Continuous Integration Example\n\n```yaml\n# .github/workflows/chart-tests.yml\nname: Chart Tests\n\non: [push, pull_request]\n\njobs:\n  unit-tests:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - uses: actions/setup-node@v3\n      - run: npm ci\n      - run: npm test -- --coverage\n      - uses: codecov/codecov-action@v3\n\n  visual-tests:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - uses: actions/setup-node@v3\n      - run: npm ci\n      - run: npm run build-storybook\n      - run: npx percy storybook ./storybook-static\n        env:\n          PERCY_TOKEN: ${{ secrets.PERCY_TOKEN }}\n\n  accessibility-tests:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - uses: actions/setup-node@v3\n      - run: npm ci\n      - run: npm run test:a11y\n\n  performance-tests:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - uses: actions/setup-node@v3\n      - run: npm ci\n      - run: npm run test:perf\n```\n\n## Sources\n\n- [Awesome Visual Regression Testing | GitHub](https://github.com/mojoaxel/awesome-regression-testing)\n- [Percy - Automated Visual Testing](https://percy.io/)\n- [Visual Testing - Functionize](https://www.functionize.com/visual-testing)\n- [Top 10 Visual Testing Tools | Applitools](https://applitools.com/blog/top-10-visual-testing-tools/)\n- [Visual Testing in Cypress | Cypress Docs](https://docs.cypress.io/app/tooling/visual-testing)\n"
        },
        {
          "name": "tufte-principles.md",
          "type": "file",
          "path": "data-viz-2025/references/tufte-principles.md",
          "size": 11515,
          "content": "# Edward Tufte's Data Visualization Principles\n\nEdward Tufte is Professor Emeritus of Political Science, Statistics, and Computer Science at Yale University. The New York Times described him as the \"Leonardo da Vinci of data,\" and Bloomberg as the \"Galileo of graphics.\"\n\nHis work, particularly \"The Visual Display of Quantitative Information\" (1983), is foundational to modern data visualization.\n\n## Core Principle: Maximize Data-Ink Ratio\n\n**Data-ink ratio = (Data-ink) / (Total ink used in graphic)**\n\nWhere:\n- **Data-ink** - Ink that represents actual data values\n- **Non-data-ink** - Decorative elements, gridlines, borders, backgrounds\n\n### Goal: Approach 1.0\n\nEvery drop of ink should represent data. Remove everything else.\n\n### Examples\n\n**‚ùå Low Data-Ink Ratio (Bad):**\n```\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó ‚îÇ\n‚îÇ ‚ïë     SALES PERFORMANCE       ‚ïë ‚îÇ  ‚Üê Heavy borders\n‚îÇ ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚îÇ\n‚îÇ ‚îè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îì ‚îÇ\n‚îÇ ‚îÉ ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë ‚îÉ ‚îÇ  ‚Üê Background pattern\n‚îÇ ‚îÉ ‚îÉ  ‚ñì‚ñì  ‚ñì‚ñì‚ñì  ‚ñì‚ñì  ‚ñì‚ñì‚ñì‚ñì      ‚îÉ ‚îÇ  ‚Üê 3D bars with gradients\n‚îÇ ‚îÉ ‚îÉ  ‚ñì‚ñì  ‚ñì‚ñì‚ñì  ‚ñì‚ñì  ‚ñì‚ñì‚ñì‚ñì      ‚îÉ ‚îÇ\n‚îÇ ‚îÉ ‚îÉ  ‚ñì‚ñì  ‚ñì‚ñì‚ñì  ‚ñì‚ñì  ‚ñì‚ñì‚ñì‚ñì      ‚îÉ ‚îÇ\n‚îÇ ‚îÉ ‚îî‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÉ ‚îÇ  ‚Üê Heavy gridlines\n‚îÇ ‚îÉ   Q1  Q2   Q3  Q4          ‚îÉ ‚îÇ\n‚îÇ ‚îó‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îõ ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n\nData-ink ratio: ~0.2 (80% is decoration)\n```\n\n**‚úÖ High Data-Ink Ratio (Good):**\n```\nSales\n250‚îÄ  ‚ï≠‚îÄ‚îÄ‚ïÆ\n200‚îÄ  ‚îÇ  ‚îÇ  ‚ï≠‚îÄ‚îÄ‚ïÆ\n150‚îÄ  ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ\n100‚îÄ‚ï≠‚îÄ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ‚ï≠‚îÄ‚ïÆ\n 50‚îÄ‚îÇ ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ‚îÇ ‚îÇ\n  0‚îÄ‚î¥‚îÄ‚î¥‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚î¥‚î¥‚îÄ‚î¥\n    Q1 Q2 Q3 Q4\n\nData-ink ratio: ~0.85 (most ink is data)\n```\n\n### Practical Implementation\n\n```typescript\n// ‚ùå BAD - Unnecessary decorations\n<BarChart data={data}>\n  <CartesianGrid strokeDasharray=\"3 3\" opacity={0.5} />  {/* Remove */}\n  <XAxis stroke=\"#666\" strokeWidth={2} />                {/* Too heavy */}\n  <YAxis stroke=\"#666\" strokeWidth={2} />\n  <Bar dataKey=\"value\" fill=\"#d97706\">\n    <LabelList position=\"top\" />                         {/* Redundant with axis */}\n  </Bar>\n  <Tooltip                                               {/* Can stay - provides info */}\n    contentStyle={{\n      border: '2px solid #000',                          {/* Remove heavy border */}\n      borderRadius: '8px',\n      boxShadow: '0 4px 12px rgba(0,0,0,0.3)'           {/* Remove shadow */}\n    }}\n  />\n</BarChart>\n\n// ‚úÖ GOOD - Data-focused\n<BarChart data={data}>\n  <XAxis stroke=\"#d1d5db\" strokeWidth={1} />            {/* Subtle, 1px */}\n  <YAxis stroke=\"#d1d5db\" strokeWidth={1} />\n  <Bar dataKey=\"value\" fill=\"#d97706\" />\n  <Tooltip                                               {/* Minimal styling */}\n    contentStyle={{\n      backgroundColor: 'white',\n      border: '1px solid #e5e7eb'\n    }}\n  />\n</BarChart>\n```\n\n## Six Principles of Graphical Integrity\n\n### 1. Proportional Representation\n\n**The representation of numbers should be directly proportional to the numerical quantities represented.**\n\n**‚ùå Bad Example: Misleading Area**\n```typescript\n// Using radius instead of area for circles\n// 2x the data = 2x the radius = 4x the visual area!\n<Circle r={value} /> // WRONG\n```\n\n**‚úÖ Good Example: Correct Proportions**\n```typescript\n// 2x the data = 2x the area\n<Circle r={Math.sqrt(value / Math.PI)} /> // CORRECT\n\n// Or just use bars (linear representation)\n<Bar height={value} />\n```\n\n### 2. Clear Labeling\n\n**Clear, detailed, and thorough labeling defeats graphical distortion and ambiguity.**\n\n**‚ùå Bad: Legend Matching Required**\n```\nSales by Region\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    ‚ï≠‚îÄ‚îÄ‚ïÆ\n  ‚ï≠‚îÄ‚îÇ  ‚îÇ\n‚îÄ‚îÄ‚îÇ ‚îÇ  ‚îÇ‚îÄ‚îÄ\n  ‚î¥‚îÄ‚î¥‚îÄ‚îÄ‚î¥\n  Q1 Q2 Q3\n\nLegend:\n‚ñ† North  ‚ñ† South  ‚ñ† East  ‚ñ† West\n```\n*User must match colors to legend, slows comprehension*\n\n**‚úÖ Good: Direct Labels**\n```\nSales by Region\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n    ‚ï≠‚îÄ‚îÄ‚ïÆ\n  ‚ï≠‚îÄ‚îÇ  ‚îÇ East $2.3M\n‚îÄ‚îÄ‚îÇ ‚îÇ  ‚îÇ‚îÄ‚îÄ\n  ‚î¥‚îÄ‚î¥‚îÄ‚îÄ‚î¥\n  North South\n  $1.8M $2.1M\n```\n*Immediate understanding, no legend required*\n\n### 3. Show Data Variation, Not Design Variation\n\n**Visual elements should encode data values, not arbitrary design choices.**\n\n**‚ùå Bad: Inconsistent Visual Encoding**\n- Using different chart types for same data\n- Varying bar widths randomly\n- Changing colors without meaning\n\n**‚úÖ Good: Consistent Visual Grammar**\n- Same chart type for comparable data\n- Uniform bar widths (only height varies)\n- Color encodes consistent categorical dimension\n\n### 4. Context Preservation\n\n**Graphics must not quote data out of context.**\n\n**‚ùå Bad: Cherry-Picked Time Range**\n```\nStock Price SOARS! üìà\n\n$100 ‚îÄ           ‚ï≠‚îÄ\n $95 ‚îÄ       ‚ï≠‚îÄ‚îÄ‚îÄ‚ïØ\n $90 ‚îÄ   ‚ï≠‚îÄ‚îÄ‚îÄ‚ïØ\n     ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ\n     Mon Tue Wed\n\nMissing: Stock was $200 last year, down 50%\n```\n\n**‚úÖ Good: Full Context**\n```\nStock Price Recovery (Still Down YoY)\n\n$200 ‚îÄ‚ïÆ\n$150 ‚îÄ ‚ï∞‚îÄ‚ïÆ\n$100 ‚îÄ   ‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚ïÆ    ‚ï≠‚îÄ\n $50 ‚îÄ         ‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚ïØ\n     ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ\n     Jan Jun Dec Mar\n     2024        2025\n\nShows recovery in context of larger decline\n```\n\n### 5. Show Cause and Effect\n\n**The number of dimensions in graphics should match the number of dimensions in data.**\n\n**‚ùå Bad: 3D for 2D Data**\n```\nUsing 3D pie chart for simple percentages\n‚Üí Perspective distorts slice sizes\n‚Üí Back slices appear smaller\n‚Üí Adds dimension that doesn't exist in data\n```\n\n**‚úÖ Good: 2D for 2D Data**\n```\nSimple 2D pie or (better) horizontal bar chart\n‚Üí Accurate size perception\n‚Üí Easy comparison\n```\n\n### 6. Label Important Events\n\n**Include labels for context-critical events in the data timeline.**\n\n```typescript\n<LineChart data={data}>\n  <ReferenceLine\n    x=\"2020-03-15\"\n    stroke=\"#dc2626\"\n    label=\"Pandemic Declared\"\n  />\n  <ReferenceLine\n    x=\"2021-12-01\"\n    stroke=\"#059669\"\n    label=\"Vaccine Rollout\"\n  />\n  {/* These annotations provide crucial context */}\n</LineChart>\n```\n\n## Chartjunk: What to Remove\n\n### Common Chartjunk Elements\n\n1. **Heavy gridlines** - If needed at all, make them subtle (stroke: 1px, opacity: 0.1)\n2. **3D effects** - Serve no purpose except confusion\n3. **Gradients in bars** - Suggest variation that doesn't exist\n4. **Decorative borders** - Waste space and ink\n5. **Background patterns** - Distract from data\n6. **Drop shadows** - Add visual weight without meaning\n7. **Redundant labels** - If axis shows value, don't also label each bar\n8. **Moir√© vibration** - High-frequency patterns that vibrate visually\n\n### Implementation Checklist\n\nBefore shipping a chart:\n\n- [ ] Remove all gridlines (or make them nearly invisible)\n- [ ] Remove 3D effects, gradients, shadows\n- [ ] Remove decorative borders and backgrounds\n- [ ] Use direct labels instead of legends where possible\n- [ ] Ensure Y-axis starts at zero for bar charts\n- [ ] Check that visual area is proportional to data values\n- [ ] Add annotations for important events or thresholds\n- [ ] Verify color contrast meets accessibility standards\n- [ ] Test on mobile - does it still work?\n\n## Small Multiples: Tufte's Favorite Technique\n\n**Instead of one overloaded chart, create many small charts arranged in a grid.**\n\n### Why Small Multiples Work\n\n1. **Comparison is easy** - Same axes, different subsets\n2. **Scales better** - 20 categories ‚Üí 20 small charts, not one chaos chart\n3. **Reduces cognitive load** - Each chart is simple\n4. **Reveals patterns** - Macro trends emerge from arrangement\n\n### Example: Sparklines\n\nTufte championed \"sparklines\" - tiny line charts embedded in text.\n\n```typescript\n// Word-sized charts in a table\n<table>\n  <tr>\n    <td>Product A</td>\n    <td>$2.3M</td>\n    <td><Sparkline data={productA} width={50} height={20} /></td>\n  </tr>\n  <tr>\n    <td>Product B</td>\n    <td>$1.8M</td>\n    <td><Sparkline data={productB} width={50} height={20} /></td>\n  </tr>\n</table>\n```\n\n### Example: Faceted Charts\n\n```typescript\n// Instead of one line chart with 12 overlapping lines (one per month)\n// Create 12 small charts (one per month) arranged in a 3√ó4 grid\n\n<div className=\"grid grid-cols-4 gap-2\">\n  {months.map(month => (\n    <div key={month} className=\"border border-gray-200 p-2\">\n      <h3 className=\"text-xs font-medium\">{month}</h3>\n      <LineChart data={dataForMonth[month]} width={120} height={80}>\n        <Line dataKey=\"value\" stroke=\"#d97706\" dot={false} />\n      </LineChart>\n    </div>\n  ))}\n</div>\n```\n\n## Color Theory (Tufte Approach)\n\n### Use Color Sparingly\n\n\"Color should be used with restraint and purpose, not decoration.\"\n\n### Color Guidelines\n\n1. **Muted palette** - Avoid neon, use desaturated colors\n2. **Highlight with color** - Gray for context, color for focus\n3. **Sequential data** - Use gradations of one hue\n4. **Categorical data** - Use maximally distinct hues\n5. **Diverging data** - Use two hues meeting at neutral center\n\n```typescript\n// ‚úÖ Good: Muted with one accent\nconst colors = {\n  background: '#fafafa',\n  grid: '#e5e7eb',        // Barely visible\n  bars: '#9ca3af',        // Gray for most bars\n  highlight: '#d97706'    // Orange for important bar\n};\n\n// ‚ùå Bad: Rainbow vomit\nconst colors = [\n  '#ff0000', '#ff7700', '#ffff00', '#00ff00',\n  '#0000ff', '#4b0082', '#9400d3', '#ff00ff'\n];\n```\n\n## Real-World Examples\n\n### Before & After: Sales Dashboard\n\n**‚ùå Before (Chartjunk):**\n- Heavy borders around everything\n- 3D bar charts with gradients\n- Gridlines every 10 units (very visible)\n- Legend at bottom (requires color matching)\n- Background pattern behind charts\n- Drop shadows on all elements\n- Six different colors for six regions\n\n**‚úÖ After (Tufte Principles):**\n- No borders, cards on white background\n- 2D bars, solid color\n- No gridlines (or invisible ones)\n- Direct labels on bars\n- Clean white background\n- No shadows\n- Gray for all bars except top performer (orange)\n\n**Result:** 3x faster comprehension in user testing, 40% more insights remembered.\n\n## Further Reading\n\n- \"The Visual Display of Quantitative Information\" (1983) - The foundational text\n- \"Envisioning Information\" (1990) - Multi-dimensional data\n- \"Visual Explanations\" (1997) - Cause and effect\n- \"Beautiful Evidence\" (2006) - Making analytical presentations\n\n## Sources\n\n- [Edward Tufte's 6 Data Visualization Principles | Medium](https://medium.com/@yahiazakaria445/edward-tuftes-6-data-visualization-principles-1193d8b49478)\n- [Mastering Tufte's Data Visualization Principles | GeeksforGeeks](https://www.geeksforgeeks.org/data-visualization/mastering-tuftes-data-visualization-principles/)\n- [The Work of Edward Tufte & Graphics Press](https://www.edwardtufte.com/)\n- [Tufte's Principles for Graphical Integrity (Service Design Institute)](https://internationalservicedesigninstitute.com/tuftes-6-principles-graphical-integrity-adopted-service-design/)\n"
        }
      ]
    },
    {
      "name": "scripts",
      "type": "folder",
      "path": "data-viz-2025/scripts",
      "children": [
        {
          "name": "chart-test-helpers.ts",
          "type": "file",
          "path": "data-viz-2025/scripts/chart-test-helpers.ts",
          "size": 10574,
          "content": "/**\n * Chart Testing Utilities\n *\n * Helper functions for testing data visualizations:\n * - Scale accuracy verification\n * - Data-visual correspondence checks\n * - Accessibility testing helpers\n * - Performance benchmarking\n *\n * Usage:\n *   import { verifyScaleAccuracy, checkContrast } from './chart-test-helpers';\n */\n\nexport interface ChartElement {\n  getAttribute(name: string): string | null;\n  getBoundingClientRect(): DOMRect;\n  style: CSSStyleDeclaration;\n}\n\n/**\n * Verify that visual heights are proportional to data values\n *\n * @example\n * const bars = screen.getAllByTestId('bar');\n * const data = [10, 20, 30];\n * verifyScaleAccuracy(bars, data, 'height')\n * // Returns true if heights are proportional\n */\nexport function verifyScaleAccuracy(\n  elements: ChartElement[],\n  dataValues: number[],\n  dimension: 'height' | 'width' | 'r' // r for circles\n): boolean {\n  if (elements.length !== dataValues.length) {\n    throw new Error('Number of elements must match number of data values');\n  }\n\n  if (elements.length < 2) {\n    return true; // Can't verify proportions with < 2 elements\n  }\n\n  const visualValues = elements.map(el => {\n    const value = el.getAttribute(dimension);\n    return value ? parseFloat(value) : 0;\n  });\n\n  // Check if ratios between consecutive elements match data ratios\n  for (let i = 1; i < elements.length; i++) {\n    const dataRatio = dataValues[i] / dataValues[i - 1];\n    const visualRatio = visualValues[i] / visualValues[i - 1];\n\n    // Allow 5% tolerance for rounding errors\n    const tolerance = 0.05;\n    const diff = Math.abs(dataRatio - visualRatio);\n\n    if (diff > tolerance * dataRatio) {\n      console.error(\n        `Scale mismatch at index ${i}: data ratio ${dataRatio}, visual ratio ${visualRatio}`\n      );\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Verify bar chart Y-axis starts at zero\n *\n * @example\n * verifyBarChartBaselineAtZero(bars, chartHeight)\n */\nexport function verifyBarChartBaselineAtZero(\n  bars: ChartElement[],\n  chartHeight: number\n): boolean {\n  // All bars should have y + height = chartHeight (bottom of chart)\n  return bars.every(bar => {\n    const y = parseFloat(bar.getAttribute('y') || '0');\n    const height = parseFloat(bar.getAttribute('height') || '0');\n    const bottom = y + height;\n\n    // Allow 1px tolerance for rounding\n    return Math.abs(bottom - chartHeight) <= 1;\n  });\n}\n\n/**\n * Check color contrast ratio (WCAG AA)\n *\n * @example\n * const bar = screen.getByTestId('bar');\n * const backgroundColor = '#ffffff';\n * checkContrast(bar, backgroundColor)\n * // Returns true if contrast ‚â• 3:1\n */\nexport function checkContrast(\n  element: ChartElement,\n  backgroundColor: string\n): boolean {\n  const foregroundColor = element.style.fill || element.style.color;\n\n  if (!foregroundColor) {\n    console.warn('No foreground color found on element');\n    return false;\n  }\n\n  const ratio = calculateContrastRatio(foregroundColor, backgroundColor);\n\n  // WCAG AA requires 3:1 for large text/graphics\n  return ratio >= 3;\n}\n\n/**\n * Calculate contrast ratio between two colors\n *\n * @example\n * calculateContrastRatio('#000000', '#ffffff')\n * // 21 (maximum contrast)\n */\nexport function calculateContrastRatio(\n  color1: string,\n  color2: string\n): number {\n  const luminance1 = getRelativeLuminance(color1);\n  const luminance2 = getRelativeLuminance(color2);\n\n  const lighter = Math.max(luminance1, luminance2);\n  const darker = Math.min(luminance1, luminance2);\n\n  return (lighter + 0.05) / (darker + 0.05);\n}\n\n/**\n * Get relative luminance of a color (WCAG formula)\n */\nfunction getRelativeLuminance(color: string): number {\n  // Convert color to RGB\n  const rgb = hexToRgb(color);\n  if (!rgb) return 0;\n\n  // Convert to sRGB\n  const rsRGB = rgb.r / 255;\n  const gsRGB = rgb.g / 255;\n  const bsRGB = rgb.b / 255;\n\n  // Apply gamma correction\n  const r =\n    rsRGB <= 0.03928 ? rsRGB / 12.92 : Math.pow((rsRGB + 0.055) / 1.055, 2.4);\n  const g =\n    gsRGB <= 0.03928 ? gsRGB / 12.92 : Math.pow((gsRGB + 0.055) / 1.055, 2.4);\n  const b =\n    bsRGB <= 0.03928 ? bsRGB / 12.92 : Math.pow((bsRGB + 0.055) / 1.055, 2.4);\n\n  // Calculate luminance\n  return 0.2126 * r + 0.7152 * g + 0.0722 * b;\n}\n\n/**\n * Convert hex color to RGB\n */\nfunction hexToRgb(hex: string): { r: number; g: number; b: number } | null {\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return result\n    ? {\n        r: parseInt(result[1], 16),\n        g: parseInt(result[2], 16),\n        b: parseInt(result[3], 16)\n      }\n    : null;\n}\n\n/**\n * Benchmark chart rendering performance\n *\n * @example\n * const time = benchmarkRender(() => render(<BarChart data={largeDataset} />))\n * expect(time).toBeLessThan(500) // < 500ms\n */\nexport function benchmarkRender(renderFn: () => void): number {\n  const start = performance.now();\n  renderFn();\n  const end = performance.now();\n  return end - start;\n}\n\n/**\n * Verify all data points are rendered\n *\n * @example\n * verifyDataPointCount(screen.getAllByTestId('bar'), mockData)\n */\nexport function verifyDataPointCount(\n  elements: ChartElement[],\n  data: any[]\n): boolean {\n  return elements.length === data.length;\n}\n\n/**\n * Verify labels match data\n *\n * @example\n * const labels = screen.getAllByTestId('axis-label');\n * verifyLabels(labels, ['Jan', 'Feb', 'Mar'])\n */\nexport function verifyLabels(\n  labelElements: Array<{ textContent: string | null }>,\n  expectedLabels: string[]\n): boolean {\n  if (labelElements.length !== expectedLabels.length) {\n    console.error(\n      `Label count mismatch: ${labelElements.length} vs ${expectedLabels.length}`\n    );\n    return false;\n  }\n\n  return labelElements.every((el, i) => {\n    const actual = el.textContent?.trim();\n    const expected = expectedLabels[i];\n\n    if (actual !== expected) {\n      console.error(`Label mismatch at index ${i}: \"${actual}\" vs \"${expected}\"`);\n      return false;\n    }\n\n    return true;\n  });\n}\n\n/**\n * Check if tooltip appears on hover\n *\n * @example\n * await verifyTooltipBehavior(\n *   screen.getByTestId('bar'),\n *   () => screen.queryByRole('tooltip')\n * )\n */\nexport async function verifyTooltipBehavior(\n  element: HTMLElement,\n  getTooltip: () => HTMLElement | null,\n  userEvent: any // @testing-library/user-event\n): Promise<boolean> {\n  // Initially, no tooltip\n  if (getTooltip()) {\n    console.error('Tooltip is visible before hover');\n    return false;\n  }\n\n  // Hover - tooltip appears\n  await userEvent.hover(element);\n\n  await new Promise(resolve => setTimeout(resolve, 100)); // Wait for animation\n\n  if (!getTooltip()) {\n    console.error('Tooltip did not appear on hover');\n    return false;\n  }\n\n  // Unhover - tooltip disappears\n  await userEvent.unhover(element);\n\n  await new Promise(resolve => setTimeout(resolve, 100));\n\n  if (getTooltip()) {\n    console.error('Tooltip did not disappear on unhover');\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Verify chart is responsive\n *\n * @example\n * verifyResponsive(chartContainer, [375, 768, 1024])\n */\nexport function verifyResponsive(\n  container: HTMLElement,\n  breakpoints: number[]\n): boolean {\n  const originalWidth = container.offsetWidth;\n\n  return breakpoints.every(width => {\n    // Resize container\n    container.style.width = `${width}px`;\n\n    // Force reflow\n    container.offsetHeight; // eslint-disable-line no-unused-expressions\n\n    // Check if chart adapted\n    const svg = container.querySelector('svg');\n    if (!svg) return false;\n\n    const svgWidth = svg.getBoundingClientRect().width;\n\n    // SVG should fill container (with some tolerance)\n    const widthMatches = Math.abs(svgWidth - width) < 5;\n\n    if (!widthMatches) {\n      console.error(\n        `Chart did not resize properly at ${width}px: SVG is ${svgWidth}px`\n      );\n    }\n\n    return widthMatches;\n  });\n\n  // Restore original width\n  container.style.width = `${originalWidth}px`;\n}\n\n/**\n * Verify chart handles empty data gracefully\n *\n * @example\n * verifyEmptyState(() => render(<Chart data={[]} />))\n */\nexport function verifyEmptyState(\n  renderFn: () => { container: HTMLElement }\n): boolean {\n  const { container } = renderFn();\n\n  // Should show empty state message\n  const emptyMessage = container.querySelector('[data-testid=\"empty-state\"]');\n  if (!emptyMessage) {\n    console.error('No empty state message found');\n    return false;\n  }\n\n  // Should not show chart elements\n  const chartElements = container.querySelectorAll('[data-testid*=\"bar\"]');\n  if (chartElements.length > 0) {\n    console.error('Chart elements rendered with empty data');\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Measure memory usage before and after render\n *\n * @example\n * const leak = detectMemoryLeak(() => {\n *   const { unmount } = render(<Chart data={data} />);\n *   unmount();\n * })\n */\nexport function detectMemoryLeak(\n  renderAndUnmountFn: () => void,\n  iterations: number = 100\n): boolean {\n  if (!performance.memory) {\n    console.warn('performance.memory not available in this environment');\n    return true;\n  }\n\n  const initialMemory = (performance as any).memory.usedJSHeapSize;\n\n  // Run render/unmount cycle multiple times\n  for (let i = 0; i < iterations; i++) {\n    renderAndUnmountFn();\n  }\n\n  // Force garbage collection if available (only in tests with --expose-gc)\n  if (global.gc) {\n    global.gc();\n  }\n\n  const finalMemory = (performance as any).memory.usedJSHeapSize;\n  const memoryIncrease = finalMemory - initialMemory;\n\n  // Allow 10MB increase (some memory growth is normal)\n  const threshold = 10 * 1024 * 1024;\n\n  if (memoryIncrease > threshold) {\n    console.error(\n      `Potential memory leak: ${(memoryIncrease / 1024 / 1024).toFixed(2)}MB increase`\n    );\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Generate snapshot-friendly chart data\n * (Removes timestamps, random values, etc.)\n *\n * @example\n * expect(sanitizeForSnapshot(chartData)).toMatchSnapshot()\n */\nexport function sanitizeForSnapshot(data: any): any {\n  if (Array.isArray(data)) {\n    return data.map(sanitizeForSnapshot);\n  }\n\n  if (typeof data === 'object' && data !== null) {\n    const sanitized: any = {};\n\n    for (const [key, value] of Object.entries(data)) {\n      // Remove timestamps\n      if (key.includes('timestamp') || key.includes('time')) {\n        sanitized[key] = '[TIMESTAMP]';\n      }\n      // Remove IDs\n      else if (key === 'id' || key.endsWith('Id')) {\n        sanitized[key] = '[ID]';\n      }\n      // Recursively sanitize nested objects\n      else {\n        sanitized[key] = sanitizeForSnapshot(value);\n      }\n    }\n\n    return sanitized;\n  }\n\n  return data;\n}\n"
        },
        {
          "name": "data-transform.ts",
          "type": "file",
          "path": "data-viz-2025/scripts/data-transform.ts",
          "size": 10135,
          "content": "/**\n * Data Transformation Utilities for Data Visualization\n *\n * Common transformations needed for chart data:\n * - Aggregation (sum, average, count)\n * - Grouping and pivoting\n * - Normalization and scaling\n * - Time series operations\n * - Statistical calculations\n *\n * Usage:\n *   import { groupBy, rollup, normalize } from './data-transform';\n */\n\nexport interface DataPoint {\n  [key: string]: any;\n}\n\n/**\n * Group data by a key\n *\n * @example\n * const data = [\n *   { category: 'A', value: 10 },\n *   { category: 'A', value: 20 },\n *   { category: 'B', value: 30 }\n * ];\n * groupBy(data, 'category')\n * // { A: [...], B: [...] }\n */\nexport function groupBy<T extends DataPoint>(\n  data: T[],\n  key: keyof T\n): Record<string, T[]> {\n  return data.reduce((acc, item) => {\n    const groupKey = String(item[key]);\n    if (!acc[groupKey]) {\n      acc[groupKey] = [];\n    }\n    acc[groupKey].push(item);\n    return acc;\n  }, {} as Record<string, T[]>);\n}\n\n/**\n * Aggregate grouped data\n *\n * @example\n * const data = [\n *   { category: 'A', value: 10 },\n *   { category: 'A', value: 20 },\n *   { category: 'B', value: 30 }\n * ];\n * rollup(data, 'category', 'value', 'sum')\n * // [{ category: 'A', value: 30 }, { category: 'B', value: 30 }]\n */\nexport function rollup<T extends DataPoint>(\n  data: T[],\n  groupKey: keyof T,\n  valueKey: keyof T,\n  aggregation: 'sum' | 'avg' | 'count' | 'min' | 'max'\n): Array<{ [K in keyof T]: T[K] }> {\n  const grouped = groupBy(data, groupKey);\n\n  return Object.entries(grouped).map(([key, items]) => {\n    let value: number;\n\n    switch (aggregation) {\n      case 'sum':\n        value = items.reduce((sum, item) => sum + Number(item[valueKey]), 0);\n        break;\n      case 'avg':\n        value =\n          items.reduce((sum, item) => sum + Number(item[valueKey]), 0) /\n          items.length;\n        break;\n      case 'count':\n        value = items.length;\n        break;\n      case 'min':\n        value = Math.min(...items.map(item => Number(item[valueKey])));\n        break;\n      case 'max':\n        value = Math.max(...items.map(item => Number(item[valueKey])));\n        break;\n    }\n\n    return {\n      [groupKey]: key,\n      [valueKey]: value\n    } as { [K in keyof T]: T[K] };\n  });\n}\n\n/**\n * Normalize values to 0-1 range\n *\n * @example\n * normalize([10, 20, 30, 40])\n * // [0, 0.333, 0.666, 1]\n */\nexport function normalize(values: number[]): number[] {\n  const min = Math.min(...values);\n  const max = Math.max(...values);\n  const range = max - min;\n\n  if (range === 0) return values.map(() => 0);\n\n  return values.map(v => (v - min) / range);\n}\n\n/**\n * Standardize values (z-score)\n *\n * @example\n * standardize([10, 20, 30, 40])\n * // [-1.161, -0.387, 0.387, 1.161]\n */\nexport function standardize(values: number[]): number[] {\n  const mean = values.reduce((sum, v) => sum + v, 0) / values.length;\n  const variance =\n    values.reduce((sum, v) => sum + Math.pow(v - mean, 2), 0) / values.length;\n  const stdDev = Math.sqrt(variance);\n\n  if (stdDev === 0) return values.map(() => 0);\n\n  return values.map(v => (v - mean) / stdDev);\n}\n\n/**\n * Calculate moving average\n *\n * @example\n * movingAverage([1, 2, 3, 4, 5], 3)\n * // [2, 3, 4] (averages of [1,2,3], [2,3,4], [3,4,5])\n */\nexport function movingAverage(values: number[], window: number): number[] {\n  if (window > values.length) {\n    throw new Error('Window size cannot exceed array length');\n  }\n\n  const result: number[] = [];\n\n  for (let i = 0; i <= values.length - window; i++) {\n    const slice = values.slice(i, i + window);\n    const avg = slice.reduce((sum, v) => sum + v, 0) / window;\n    result.push(avg);\n  }\n\n  return result;\n}\n\n/**\n * Calculate percentage change\n *\n * @example\n * percentageChange(100, 150)\n * // 50 (increased by 50%)\n */\nexport function percentageChange(oldValue: number, newValue: number): number {\n  if (oldValue === 0) return newValue === 0 ? 0 : Infinity;\n  return ((newValue - oldValue) / Math.abs(oldValue)) * 100;\n}\n\n/**\n * Bin continuous data into discrete ranges\n *\n * @example\n * bin([1, 5, 10, 15, 20, 25], 3)\n * // [\n * //   { range: '1-9', count: 2, values: [1, 5] },\n * //   { range: '10-18', count: 2, values: [10, 15] },\n * //   { range: '19-27', count: 2, values: [20, 25] }\n * // ]\n */\nexport function bin(\n  values: number[],\n  numBins: number\n): Array<{ range: string; count: number; values: number[] }> {\n  const min = Math.min(...values);\n  const max = Math.max(...values);\n  const binSize = (max - min) / numBins;\n\n  const bins: Array<{ range: string; count: number; values: number[] }> = [];\n\n  for (let i = 0; i < numBins; i++) {\n    const binMin = min + i * binSize;\n    const binMax = min + (i + 1) * binSize;\n\n    const binValues = values.filter(\n      v => v >= binMin && (i === numBins - 1 ? v <= binMax : v < binMax)\n    );\n\n    bins.push({\n      range: `${Math.round(binMin)}-${Math.round(binMax)}`,\n      count: binValues.length,\n      values: binValues\n    });\n  }\n\n  return bins;\n}\n\n/**\n * Pivot data (rows to columns)\n *\n * @example\n * const data = [\n *   { date: '2024-01', category: 'A', value: 10 },\n *   { date: '2024-01', category: 'B', value: 20 },\n *   { date: '2024-02', category: 'A', value: 15 }\n * ];\n * pivot(data, 'date', 'category', 'value')\n * // [\n * //   { date: '2024-01', A: 10, B: 20 },\n * //   { date: '2024-02', A: 15, B: null }\n * // ]\n */\nexport function pivot<T extends DataPoint>(\n  data: T[],\n  rowKey: keyof T,\n  colKey: keyof T,\n  valueKey: keyof T\n): DataPoint[] {\n  const rows = new Map<string, DataPoint>();\n\n  data.forEach(item => {\n    const row = String(item[rowKey]);\n    const col = String(item[colKey]);\n    const value = item[valueKey];\n\n    if (!rows.has(row)) {\n      rows.set(row, { [rowKey]: row });\n    }\n\n    rows.get(row)![col] = value;\n  });\n\n  return Array.from(rows.values());\n}\n\n/**\n * Calculate cumulative sum\n *\n * @example\n * cumulativeSum([1, 2, 3, 4])\n * // [1, 3, 6, 10]\n */\nexport function cumulativeSum(values: number[]): number[] {\n  let sum = 0;\n  return values.map(v => {\n    sum += v;\n    return sum;\n  });\n}\n\n/**\n * Sort data by multiple keys\n *\n * @example\n * const data = [\n *   { category: 'B', value: 20 },\n *   { category: 'A', value: 10 },\n *   { category: 'A', value: 30 }\n * ];\n * sortBy(data, ['category', 'asc'], ['value', 'desc'])\n * // [\n * //   { category: 'A', value: 30 },\n * //   { category: 'A', value: 10 },\n * //   { category: 'B', value: 20 }\n * // ]\n */\nexport function sortBy<T extends DataPoint>(\n  data: T[],\n  ...sortKeys: Array<[keyof T, 'asc' | 'desc']>\n): T[] {\n  return [...data].sort((a, b) => {\n    for (const [key, direction] of sortKeys) {\n      const aVal = a[key];\n      const bVal = b[key];\n\n      let comparison = 0;\n\n      if (aVal < bVal) comparison = -1;\n      if (aVal > bVal) comparison = 1;\n\n      if (comparison !== 0) {\n        return direction === 'asc' ? comparison : -comparison;\n      }\n    }\n\n    return 0;\n  });\n}\n\n/**\n * Fill missing dates in time series\n *\n * @example\n * const data = [\n *   { date: new Date('2024-01-01'), value: 10 },\n *   { date: new Date('2024-01-03'), value: 30 }\n * ];\n * fillMissingDates(data, 'day', 0)\n * // [\n * //   { date: new Date('2024-01-01'), value: 10 },\n * //   { date: new Date('2024-01-02'), value: 0 },\n * //   { date: new Date('2024-01-03'), value: 30 }\n * // ]\n */\nexport function fillMissingDates<T extends { date: Date; value: number }>(\n  data: T[],\n  interval: 'day' | 'week' | 'month',\n  fillValue: number = 0\n): T[] {\n  if (data.length === 0) return [];\n\n  const sorted = [...data].sort((a, b) => a.date.getTime() - b.date.getTime());\n  const start = sorted[0].date;\n  const end = sorted[sorted.length - 1].date;\n\n  const result: T[] = [];\n  const existingDates = new Set(sorted.map(d => d.date.toISOString()));\n\n  let current = new Date(start);\n\n  while (current <= end) {\n    const dateStr = current.toISOString();\n\n    if (existingDates.has(dateStr)) {\n      result.push(sorted.find(d => d.date.toISOString() === dateStr)!);\n    } else {\n      result.push({\n        date: new Date(current),\n        value: fillValue\n      } as T);\n    }\n\n    // Increment date based on interval\n    switch (interval) {\n      case 'day':\n        current.setDate(current.getDate() + 1);\n        break;\n      case 'week':\n        current.setDate(current.getDate() + 7);\n        break;\n      case 'month':\n        current.setMonth(current.getMonth() + 1);\n        break;\n    }\n  }\n\n  return result;\n}\n\n/**\n * Calculate trend (linear regression slope)\n *\n * @example\n * calculateTrend([10, 20, 30, 40])\n * // 10 (increasing by 10 per period)\n */\nexport function calculateTrend(values: number[]): number {\n  const n = values.length;\n  const xMean = (n - 1) / 2; // 0, 1, 2, ... n-1\n  const yMean = values.reduce((sum, v) => sum + v, 0) / n;\n\n  let numerator = 0;\n  let denominator = 0;\n\n  for (let i = 0; i < n; i++) {\n    numerator += (i - xMean) * (values[i] - yMean);\n    denominator += Math.pow(i - xMean, 2);\n  }\n\n  return denominator === 0 ? 0 : numerator / denominator;\n}\n\n/**\n * Detect outliers using IQR method\n *\n * @example\n * detectOutliers([1, 2, 3, 4, 5, 100])\n * // [100]\n */\nexport function detectOutliers(values: number[]): number[] {\n  const sorted = [...values].sort((a, b) => a - b);\n  const q1Index = Math.floor(sorted.length * 0.25);\n  const q3Index = Math.floor(sorted.length * 0.75);\n\n  const q1 = sorted[q1Index];\n  const q3 = sorted[q3Index];\n  const iqr = q3 - q1;\n\n  const lowerBound = q1 - 1.5 * iqr;\n  const upperBound = q3 + 1.5 * iqr;\n\n  return values.filter(v => v < lowerBound || v > upperBound);\n}\n\n/**\n * Sample data (for performance with large datasets)\n *\n * @example\n * sample(largeDataset, 100, 'random')\n * // Returns 100 random points\n */\nexport function sample<T>(\n  data: T[],\n  size: number,\n  method: 'random' | 'systematic' = 'random'\n): T[] {\n  if (size >= data.length) return data;\n\n  if (method === 'random') {\n    const shuffled = [...data].sort(() => Math.random() - 0.5);\n    return shuffled.slice(0, size);\n  }\n\n  // Systematic sampling (evenly spaced)\n  const step = Math.floor(data.length / size);\n  return data.filter((_, i) => i % step === 0).slice(0, size);\n}\n"
        }
      ]
    },
    {
      "name": "README.md",
      "type": "file",
      "path": "data-viz-2025/README.md",
      "size": 9230,
      "content": "# Data Viz 2025: State-of-the-Art Data Visualization Skill\n\n> Create visualizations that Seaborn users, Tufte readers, and everyone else will love.\n\nA comprehensive skill for building production-ready data visualizations in React/Next.js/TypeScript with Tailwind CSS. Combines NYT Graphics rigor, Tufte principles, and modern animation patterns.\n\n## What This Skill Provides\n\n### Core Philosophy\n- **Clarity** (Tufte's Data-Ink Ratio) - Every visual element must earn its place\n- **Beauty** (Aesthetic Standards) - Visualizations are art, use premium design\n- **Truth** (Graphical Integrity) - Data representation must be honest and tested\n\n### Complete Coverage\n\n1. **Library Selection** - Decision trees for Observable Plot, Recharts, Nivo, Visx, D3.js\n2. **Design Principles** - Tufte's data-ink ratio, graphical integrity, chartjunk removal\n3. **Testing Strategies** - Visual regression, data accuracy, accessibility, performance\n4. **Animation Patterns** - Spring physics, micro-interactions, scrollytelling\n5. **Data Storytelling** - Narrative techniques, progressive disclosure, annotated insights\n6. **Utility Scripts** - Data transformation and chart testing helpers\n7. **Production Examples** - Battle-tested components with accessibility built-in\n\n## Quick Start\n\n### Installation\n\n```bash\n# Add to your Claude skills directory\ncp -r data-viz-2025 ~/.claude/skills/\n\n# Or use the Skill tool in Claude Code:\n# \"Use the data-viz-2025 skill to create a chart\"\n```\n\n### Basic Usage\n\n```typescript\n// 1. Choose your library (see SKILL.md decision tree)\nnpm install recharts framer-motion\n\n// 2. Import utilities\nimport { rollup, normalize } from './scripts/data-transform';\nimport { verifyScaleAccuracy } from './scripts/chart-test-helpers';\n\n// 3. Build your chart\nimport { AnimatedBarChart } from './assets/example-chart';\n\n<AnimatedBarChart\n  data={salesData}\n  title=\"Q4 Sales by Channel\"\n  highlightCategory=\"Mobile\"\n/>\n```\n\n## File Structure\n\n```\ndata-viz-2025/\n‚îú‚îÄ‚îÄ SKILL.md                           # Core skill instructions\n‚îú‚îÄ‚îÄ README.md                          # This file\n‚îÇ\n‚îú‚îÄ‚îÄ references/                        # Deep-dive documentation\n‚îÇ   ‚îú‚îÄ‚îÄ tufte-principles.md           # Data-ink ratio, graphical integrity\n‚îÇ   ‚îú‚îÄ‚îÄ library-comparison.md         # Observable Plot vs Recharts vs Nivo vs Visx vs D3\n‚îÇ   ‚îú‚îÄ‚îÄ testing-strategies.md         # Visual regression, data accuracy, a11y\n‚îÇ   ‚îú‚îÄ‚îÄ animation-patterns.md         # Motion design for charts\n‚îÇ   ‚îî‚îÄ‚îÄ data-storytelling.md          # Narrative techniques, scrollytelling\n‚îÇ\n‚îú‚îÄ‚îÄ scripts/                           # Utility functions\n‚îÇ   ‚îú‚îÄ‚îÄ data-transform.ts             # groupBy, rollup, normalize, pivot, etc.\n‚îÇ   ‚îî‚îÄ‚îÄ chart-test-helpers.ts         # verifyScaleAccuracy, checkContrast, etc.\n‚îÇ\n‚îî‚îÄ‚îÄ assets/                            # Production examples\n    ‚îî‚îÄ‚îÄ example-chart.tsx              # Complete animated bar chart\n```\n\n## Key Features\n\n### Decision Trees for Library Selection\n\n**Need to make 50 prototypes fast?** ‚Üí Observable Plot\n**Building standard business charts?** ‚Üí Recharts\n**Want beautiful defaults?** ‚Üí Nivo\n**Need maximum control?** ‚Üí Visx or D3.js\n\nSee `SKILL.md` for complete decision tree.\n\n### Tufte Principles Built-In\n\n- ‚úÖ Maximize data-ink ratio\n- ‚úÖ Ensure graphical integrity\n- ‚úÖ Remove chartjunk\n- ‚úÖ Use small multiples for comparison\n- ‚úÖ Direct labels (not legends)\n\nSee `references/tufte-principles.md` for examples.\n\n### Testing at Every Level\n\n```typescript\n// Data accuracy\nverifyScaleAccuracy(bars, dataValues, 'height');\n\n// Visual regression (Percy)\nnpx percy storybook ./storybook-static\n\n// Accessibility\nconst results = await axe(container);\nexpect(results).toHaveNoViolations();\n\n// Performance\nconst time = benchmarkRender(() => render(<Chart />));\nexpect(time).toBeLessThan(500);\n```\n\nSee `references/testing-strategies.md` for comprehensive test suites.\n\n### Animation Patterns\n\n```typescript\n// Spring physics (not linear easing)\ntransition={{\n  type: \"spring\",\n  stiffness: 300,\n  damping: 30\n}}\n\n// Stagger children\ntransition={{ staggerChildren: 0.1 }}\n\n// Respect reduced motion\nconst shouldReduceMotion = useReducedMotion();\n```\n\nSee `references/animation-patterns.md` for complete patterns library.\n\n### Data Storytelling Framework\n\nEvery visualization should tell a story:\n1. **Hook** - What's the surprising insight?\n2. **Context** - Why should we care?\n3. **Evidence** - Show the data clearly\n4. **Conclusion** - What should we do?\n\nSee `references/data-storytelling.md` for narrative techniques.\n\n## Common Workflows\n\n### Building a Chart from Scratch\n\n```bash\n1. Research your data (use Observable Plot for prototyping)\n2. Choose production library (Recharts for most cases)\n3. Implement with Tufte principles (high data-ink ratio)\n4. Add animations (spring physics, stagger)\n5. Write tests (data accuracy + visual regression)\n6. Add accessibility (ARIA labels, data table alternative)\n7. Ship with confidence\n```\n\n### Improving an Existing Chart\n\n```bash\n1. Run through Tufte checklist (see SKILL.md)\n2. Remove chartjunk (gridlines, 3D, shadows)\n3. Add direct labels (replace legends)\n4. Verify accessibility (axe, contrast ratios)\n5. Add micro-interactions (hover states)\n6. Test on mobile\n7. Take Percy snapshot\n```\n\n## Utility Functions\n\n### Data Transformations\n\n```typescript\nimport { groupBy, rollup, normalize, pivot } from './scripts/data-transform';\n\n// Group by category\nconst grouped = groupBy(data, 'category');\n\n// Aggregate\nconst totals = rollup(data, 'category', 'value', 'sum');\n\n// Normalize to 0-1\nconst normalized = normalize([10, 20, 30]);\n\n// Pivot table\nconst pivoted = pivot(data, 'date', 'category', 'value');\n```\n\nSee `scripts/data-transform.ts` for 20+ utility functions.\n\n### Chart Testing\n\n```typescript\nimport { verifyScaleAccuracy, checkContrast } from './scripts/chart-test-helpers';\n\n// Verify bars are proportional\nverifyScaleAccuracy(bars, dataValues, 'height');\n\n// Check WCAG contrast\ncheckContrast(bar, '#ffffff'); // true if ‚â•3:1\n\n// Benchmark performance\nconst time = benchmarkRender(() => render(<Chart />));\n```\n\nSee `scripts/chart-test-helpers.ts` for complete testing toolkit.\n\n## Best Practices\n\n### DO ‚úÖ\n\n- Start with Observable Plot for prototyping\n- Use Recharts for standard business charts\n- Maximize data-ink ratio (remove gridlines, borders)\n- Provide data table alternative for accessibility\n- Use spring physics for animations\n- Respect `prefers-reduced-motion`\n- Test with Percy or Chromatic\n- Use skeleton loaders (not spinners)\n\n### DON'T ‚ùå\n\n- Use 3D effects or gradients (distort perception)\n- Start Y-axis at non-zero for bar charts (misleading)\n- Rely on color alone (use shapes, labels too)\n- Use rainbow color schemes (hard to interpret)\n- Animate without purpose (decoration)\n- Skip accessibility testing\n- Use `<Loader2 className=\"animate-spin\" />`\n\n## Inspiration Sources\n\n- [ObservableHQ Featured](https://observablehq.com/@observablehq/explore-featured-collections)\n- [Information is Beautiful Awards](https://www.informationisbeautifulawards.com/)\n- [NYT Graphics](https://twitter.com/nytgraphics)\n- [The Pudding](https://pudding.cool/)\n- [FlowingData](https://flowingdata.com/)\n\n## Reference Materials\n\n| File | Contents |\n|------|----------|\n| `references/tufte-principles.md` | Edward Tufte's foundational principles |\n| `references/library-comparison.md` | Observable Plot vs Recharts vs Nivo vs Visx vs D3 |\n| `references/testing-strategies.md` | Visual regression, data accuracy, a11y |\n| `references/animation-patterns.md` | Spring physics, micro-interactions, scrollytelling |\n| `references/data-storytelling.md` | Narrative techniques, progressive disclosure |\n\n## Success Criteria\n\nBefore shipping a chart, verify:\n\n- [ ] High data-ink ratio (gridlines removed or minimal)\n- [ ] Graphical integrity (proportional representation)\n- [ ] Direct labels (not legends requiring color matching)\n- [ ] Accessibility (WCAG AA, keyboard nav, screen reader support)\n- [ ] Responsive (mobile-first, touch targets ‚â•44px)\n- [ ] Tested (data accuracy + visual regression)\n- [ ] Animated (spring physics, respects reduced motion)\n- [ ] Loading state (skeleton, not spinner)\n- [ ] Error handling (graceful degradation)\n- [ ] Empty state (helpful message)\n\n## Contributing\n\nFound a pattern that works well? Add it!\n\n1. Document in appropriate reference file\n2. Add utility function if reusable\n3. Update SKILL.md if changes core workflow\n4. Test thoroughly\n5. Share examples in `assets/`\n\n## Sources\n\nThis skill synthesizes best practices from:\n\n- Edward Tufte - \"The Visual Display of Quantitative Information\" (1983)\n- New York Times Graphics Team\n- ObservableHQ community\n- Modern React visualization libraries\n- WCAG 2.1 accessibility standards\n- 2025 web performance best practices\n\n## Version\n\n**1.0.0** (January 2026)\n\nInitial release covering:\n- Library selection framework\n- Tufte principles\n- Testing strategies\n- Animation patterns\n- Data storytelling\n- Utility scripts\n- Production examples\n\n---\n\n**Remember:** The best visualization is the one that makes the insight obvious. When in doubt, simplify.\n"
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "data-viz-2025/SKILL.md",
      "size": 16641,
      "content": "---\nname: data-viz-2025\ndescription: State-of-the-art data visualization for React/Next.js/TypeScript with Tailwind CSS. Creates compelling, tested, and accessible visualizations following Tufte principles and NYT Graphics standards. Activate on \"data viz\", \"chart\", \"graph\", \"visualization\", \"dashboard\", \"plot\", \"Recharts\", \"Nivo\", \"D3\". NOT for static images, print graphics, or basic HTML tables.\nallowed-tools: Read,Write,Edit,Bash\n---\n\n# Data Visualization 2025: The Art & Science of Visual Communication\n\nCreate visualizations that Seaborn users, Tufte readers, and everyone else will love. Marry NYT Graphics rigor with MoMA aesthetics, Nike energy, and On Kawara precision.\n\n## When to Use This Skill\n\n‚úÖ **Use for:**\n- Building interactive charts, dashboards, and data stories\n- Complex visualizations (chord diagrams, Sankey flows, network graphs)\n- Real-time data displays with animations\n- Mobile-responsive data components\n- Accessible, tested visualizations for production\n\n‚ùå **NOT for:**\n- Static PNG/SVG exports without interaction (use design tools)\n- Basic HTML tables (use semantic markup)\n- Print-only graphics (different constraints)\n- Simple icon displays (use icon libraries)\n\n## Core Philosophy: The Three Pillars\n\n### 1. **Clarity** (Tufte's Data-Ink Ratio)\nEvery visual element must earn its place. Remove chart junk, maximize signal-to-noise.\n\n### 2. **Beauty** (Aesthetic Standards)\nVisualizations are art. Use spring physics, thoughtful color, and premium design systems.\n\n### 3. **Truth** (Graphical Integrity)\nData representation must be honest. Test rigorously, document assumptions, preserve context.\n\n## Quick Decision Tree\n\n```\nWhat are you building?\n‚îú‚îÄ Exploratory analysis / many iterations\n‚îÇ  ‚îî‚îÄ ‚Üí Observable Plot (grammar-of-graphics)\n‚îÇ\n‚îú‚îÄ Standard business charts (bars, lines, pies)\n‚îÇ  ‚îú‚îÄ Simple React integration needed\n‚îÇ  ‚îÇ  ‚îî‚îÄ ‚Üí Recharts (easiest, most popular)\n‚îÇ  ‚îî‚îÄ Premium aesthetics + theming\n‚îÇ     ‚îî‚îÄ ‚Üí Nivo (beautiful out of the box)\n‚îÇ\n‚îú‚îÄ Custom, one-of-a-kind visualizations\n‚îÇ  ‚îú‚îÄ Need low-level control\n‚îÇ  ‚îÇ  ‚îî‚îÄ ‚Üí Visx (React + D3 primitives)\n‚îÇ  ‚îî‚îÄ Full D3 power\n‚îÇ     ‚îî‚îÄ ‚Üí D3.js directly (steeper learning curve)\n‚îÇ\n‚îî‚îÄ Dashboard with Tailwind design system\n   ‚îú‚îÄ ‚Üí Tremor (purpose-built for dashboards)\n   ‚îî‚îÄ ‚Üí shadcn-ui Charts (Recharts + shadcn styling)\n```\n\n## The Data Viz Stack (2025)\n\n### Recommended Packages\n\n```json\n{\n  \"dependencies\": {\n    \"@observablehq/plot\": \"^0.6.0\",        // Exploratory, grammar-of-graphics\n    \"recharts\": \"^2.12.0\",                  // React charts, simple & popular\n    \"@nivo/core\": \"^0.87.0\",                // Beautiful, themeable charts\n    \"@visx/visx\": \"^3.10.0\",                // Low-level D3 + React primitives\n    \"d3\": \"^7.9.0\",                         // Direct D3 for custom work\n    \"@tremor/react\": \"^3.15.0\",             // Tailwind dashboard components\n    \"framer-motion\": \"^11.0.0\"              // Smooth animations\n  },\n  \"devDependencies\": {\n    \"@percy/cli\": \"^1.29.0\",                // Visual regression testing\n    \"@testing-library/react\": \"^14.2.0\",    // Component testing\n    \"@storybook/react\": \"^7.6.0\"            // Component playground\n  }\n}\n```\n\n### When to Use Each Library\n\n**Observable Plot** - You want ggplot2/Vega-Lite in JavaScript\n- Grammar-of-graphics approach (marks, scales, transforms)\n- Perfect for rapid prototyping\n- Great for notebooks and exploratory analysis\n\n**Recharts** - You want it to \"just work\" in React\n- Component-based (everything is a `<Component />`)\n- Excellent documentation and community\n- TypeScript support built-in\n- Smallest learning curve\n\n**Nivo** - You want visually stunning results\n- 20+ chart types with beautiful defaults\n- Canvas, SVG, and HTML rendering\n- Server-side rendering support (unique feature)\n- Extensive customization via props\n\n**Visx** - You want maximum control with React patterns\n- Low-level primitives (scales, axes, shapes)\n- Compose your own chart types\n- Airbnb's D3 + React toolkit\n- Best for novel visualizations\n\n**D3.js** - You want unlimited power (and responsibility)\n- Full control over every pixel\n- Steepest learning curve\n- Best for advanced, custom work\n- Use with `useEffect` and `useRef` in React\n\n## The Tufte Checklist\n\nBefore shipping any visualization, verify:\n\n- [ ] **Data-ink ratio maximized** - Remove gridlines, decorations, 3D effects, shadows\n- [ ] **Graphical integrity** - Visual representation proportional to data values\n- [ ] **Clear labeling** - Direct labels on data (not legends requiring color matching)\n- [ ] **No chart junk** - No unnecessary ornamentation or Moir√© vibration\n- [ ] **Layered information** - Use small multiples instead of overloaded single charts\n- [ ] **Show data variation, not design variation** - Consistent visual encoding\n\nRead `references/tufte-principles.md` for deep dive.\n\n## The NYT Graphics Workflow\n\nThe New York Times graphics team process:\n\n1. **Make 500 charts** ‚Üí Pick the one that displays information best\n2. **Simplify within reason** ‚Üí Remove noise and clutter\n3. **Annotate with insight** ‚Üí Words should highlight patterns, not just describe data\n4. **Test with real users** ‚Üí Watch people interact, identify confusion\n5. **Responsive by default** ‚Üí Mobile-first, progressive enhancement\n\nRead `references/nyt-workflow.md` for case studies.\n\n## Animation & Micro-interactions\n\nData viz isn't static. Movement communicates:\n\n### When to Animate\n- **State transitions** - Data updates, filter changes\n- **Draw attention** - Highlight insights, guide the eye\n- **Show relationships** - Morphing between views reveals structure\n- **Delight** - Thoughtful motion = premium feel\n\n### Animation Principles\n```typescript\n// Use spring physics, not linear easing\nconst springConfig = {\n  type: \"spring\",\n  stiffness: 300,\n  damping: 30\n};\n\n// Stagger for multiple elements\nconst staggerChildren = {\n  delayChildren: 0.1,\n  staggerChildren: 0.05\n};\n\n// Respect prefers-reduced-motion\nconst shouldAnimate = !window.matchMedia('(prefers-reduced-motion: reduce)').matches;\n```\n\nRead `references/animation-patterns.md` for complete patterns library.\n\n## Color: Beyond the Rainbow\n\n### Semantic Color Systems\n```typescript\n// Qualitative (categorical data)\nconst categorical = [\n  \"#d97706\", \"#7c3aed\", \"#059669\", \"#dc2626\", \"#2563eb\"\n];\n\n// Sequential (ordered data, low to high)\nconst sequential = [\n  \"#fef3c7\", \"#fcd34d\", \"#f59e0b\", \"#d97706\", \"#92400e\"\n];\n\n// Diverging (data with meaningful center)\nconst diverging = [\n  \"#dc2626\", \"#f87171\", \"#fef2f2\", \"#c7d2fe\", \"#6366f1\"\n];\n```\n\n### Accessibility Requirements\n- **Contrast ratio ‚â•4.5:1** for text on backgrounds\n- **Don't rely on color alone** - Use shapes, patterns, labels\n- **Colorblind-safe palettes** - Test with simulators\n- **Consider dark mode** - Colors must work in both themes\n\n## Testing Data Visualizations\n\n### Visual Regression Testing\n```bash\n# Percy - Automated visual testing\nnpx percy snapshot ./storybook-static\n\n# Chromatic - For Storybook\nnpx chromatic --project-token=<token>\n```\n\n### Data Accuracy Testing\n```typescript\n// Verify rendered elements match data\ntest('bar chart renders correct number of bars', () => {\n  const data = [{ x: 'A', y: 10 }, { x: 'B', y: 20 }];\n  render(<BarChart data={data} />);\n\n  const bars = screen.getAllByTestId('bar');\n  expect(bars).toHaveLength(2);\n});\n\n// Verify scale accuracy\ntest('bar heights proportional to values', () => {\n  const data = [{ x: 'A', y: 10 }, { x: 'B', y: 20 }];\n  render(<BarChart data={data} />);\n\n  const bars = screen.getAllByTestId('bar');\n  const heights = bars.map(b => parseInt(b.style.height));\n  expect(heights[1]).toBe(heights[0] * 2); // B is 2x A\n});\n```\n\nRead `references/testing-strategies.md` for comprehensive test suites.\n\n## Responsive Design Patterns\n\n### Mobile-First Approach\n```typescript\n// Desktop: Show everything\n// Tablet: Simplify axes, reduce labels\n// Mobile: Minimal chart, key insights only\n\nconst ChartResponsive = ({ data }: Props) => {\n  const isMobile = useMediaQuery('(max-width: 640px)');\n\n  return (\n    <ResponsiveContainer width=\"100%\" height={isMobile ? 200 : 400}>\n      <LineChart data={data}>\n        {!isMobile && <CartesianGrid strokeDasharray=\"3 3\" />}\n        <XAxis\n          dataKey=\"date\"\n          tick={isMobile ? { fontSize: 10 } : undefined}\n          interval={isMobile ? 'preserveStartEnd' : 'auto'}\n        />\n        <YAxis tick={isMobile ? false : undefined} />\n        <Tooltip />\n        <Line type=\"monotone\" dataKey=\"value\" stroke=\"#d97706\" />\n      </LineChart>\n    </ResponsiveContainer>\n  );\n};\n```\n\n### Touch-Friendly Interactions\n- **Minimum touch target: 44√ó44px** - Tooltips, buttons, interactive elements\n- **Swipe gestures** - Navigate time series, change views\n- **Pinch-to-zoom** - For dense charts (use carefully)\n- **Long-press context menus** - Advanced actions\n\n## Data Storytelling\n\nEvery visualization tells a story. Follow the narrative arc:\n\n1. **Hook** - What's the surprising insight?\n2. **Context** - Why should we care?\n3. **Evidence** - Show the data clearly\n4. **Conclusion** - What should we do?\n\n### Narrative Techniques\n- **Scrollytelling** - Charts animate as user scrolls\n- **Progressive disclosure** - Start simple, reveal complexity\n- **Annotations** - Point out the insight, don't make users hunt\n- **Comparison** - Show before/after, us vs. them, expected vs. actual\n\nRead `references/data-storytelling.md` for narrative frameworks.\n\n## Common Anti-Patterns\n\n### ‚ùå The \"Rainbow Vomit\" Pie Chart\n**Problem:** 12 colors, tiny slices, legend on the side\n**Solution:** Max 5 categories, direct labels, consider bar chart instead\n\n### ‚ùå The \"Misleading Axis\" Bar Chart\n**Problem:** Y-axis doesn't start at zero, exaggerates differences\n**Solution:** Always start at zero for bar charts (lines can vary)\n\n### ‚ùå The \"Dual-Axis Confusion\" Line Chart\n**Problem:** Two Y-axes with different scales mislead viewers\n**Solution:** Use separate charts or normalize to same scale\n\n### ‚ùå The \"3D Perspective\" Lie\n**Problem:** 3D effects distort data perception\n**Solution:** Stick to 2D, use color/size for third dimension\n\n### ‚ùå The \"Spinner of Death\" Loading State\n**Problem:** Empty screen with spinner for 2+ seconds\n**Solution:** Skeleton loading that shows chart structure immediately\n\nRead `references/antipatterns.md` for exhaustive catalog.\n\n## Implementation Workflow\n\n### 1. Explore Your Data\n```bash\n# Use Observable Plot for rapid iteration\nnpm install @observablehq/plot\n\n# Create throwaway prototypes, iterate fast\n# When you find the right chart, implement in production library\n```\n\n### 2. Build Production Component\n```typescript\n// Use Recharts for standard charts\n// Use Nivo for beautiful, themeable charts\n// Use Visx/D3 for custom visualizations\n\n// Always wrap in error boundaries\n// Always show skeleton loading state\n// Always handle empty/loading/error states\n```\n\n### 3. Test Thoroughly\n```bash\n# Visual regression testing\nnpx percy snapshot\n\n# Component testing\nnpm test -- --coverage\n\n# Accessibility testing\nnpx axe-core src/components/charts\n```\n\n### 4. Document & Deploy\n```typescript\n// Storybook for component playground\n// Props documentation with TypeScript\n// Usage examples for each chart type\n```\n\n## AI-Enhanced Visualizations\n\n### When to Use Claude/Haiku\n- **Dynamic annotations** - Generate insights from data\n- **Color palette suggestions** - AI-powered color harmony\n- **Chart type recommendations** - \"What's the best way to show this?\"\n- **Accessibility descriptions** - Auto-generate alt text\n\n### Example: AI Annotation\n```typescript\nconst generateInsight = async (data: DataPoint[]) => {\n  const response = await fetch('/api/claude', {\n    method: 'POST',\n    body: JSON.stringify({\n      model: 'claude-haiku',\n      prompt: `Analyze this data and provide ONE key insight (max 15 words): ${JSON.stringify(data)}`\n    })\n  });\n\n  return response.text(); // \"Sales peaked in Q3, driven by mobile conversions\"\n};\n```\n\n## Inspiration Galleries\n\n**Study these regularly:**\n- [ObservableHQ Featured Notebooks](https://observablehq.com/@observablehq/explore-featured-collections)\n- [Information is Beautiful Awards](https://www.informationisbeautifulawards.com/)\n- [NYT Graphics on Twitter](https://twitter.com/nytgraphics)\n- [FlowingData](https://flowingdata.com/)\n- [Datawrapper River](https://river.datawrapper.de/)\n- [The Pudding](https://pudding.cool/)\n\n## Performance Optimization\n\n### Bundle Size Management\n```typescript\n// ‚ùå DON'T import entire library\nimport { LineChart } from 'recharts';\n\n// ‚úÖ DO tree-shake where possible\nimport LineChart from 'recharts/lib/chart/LineChart';\n\n// Use dynamic imports for heavy charts\nconst HeavyChart = dynamic(() => import('./HeavyChart'), {\n  loading: () => <ChartSkeleton />,\n  ssr: false // Disable SSR for client-only charts\n});\n```\n\n### Canvas vs SVG\n- **SVG** - Better for < 1000 data points, accessibility, crisp at any scale\n- **Canvas** - Better for > 1000 data points, animations, performance\n- **WebGL** - Best for > 10,000 data points, 3D, gaming-level performance\n\n### Virtualization\nFor large datasets, render only visible portion:\n```typescript\n// Use react-window or react-virtualized for long lists\n// Aggregate/sample data for chart display\n// Store full dataset separately for export\n```\n\n## Accessibility Standards (WCAG AA)\n\n### Requirements\n- **Keyboard navigation** - All interactive elements accessible via Tab\n- **Screen reader support** - Provide data tables as alternative\n- **Focus indicators** - Visible focus states for interactive elements\n- **Color contrast** - ‚â•4.5:1 for small text, ‚â•3:1 for large text\n- **Reduced motion** - Respect `prefers-reduced-motion: reduce`\n\n### Implementation\n```typescript\n<figure role=\"img\" aria-labelledby=\"chart-title chart-desc\">\n  <h2 id=\"chart-title\">Sales Over Time</h2>\n  <p id=\"chart-desc\">\n    Line chart showing sales increased 45% from Q1 to Q4,\n    peaking in November at $2.3M.\n  </p>\n\n  <LineChart data={data} />\n\n  {/* Provide data table alternative */}\n  <details>\n    <summary>View data table</summary>\n    <table>...</table>\n  </details>\n</figure>\n```\n\n## Reference Materials\n\nThis skill includes comprehensive reference documentation:\n\n- **`references/tufte-principles.md`** - Edward Tufte's data visualization principles with examples\n- **`references/library-comparison.md`** - Deep dive on Observable Plot, Recharts, Nivo, Visx, D3\n- **`references/testing-strategies.md`** - Visual regression, component testing, accessibility testing\n- **`references/animation-patterns.md`** - Motion design patterns for charts\n- **`references/data-storytelling.md`** - Narrative techniques and scrollytelling patterns\n- **`references/antipatterns.md`** - Common mistakes and how to avoid them\n- **`references/nyt-workflow.md`** - New York Times graphics team best practices\n\n## Utility Scripts\n\n- **`scripts/data-transform.ts`** - Common data transformations (rollup, pivot, normalize)\n- **`scripts/chart-test-helpers.ts`** - Testing utilities for verifying chart accuracy\n- **`scripts/color-palette-generator.ts`** - Generate accessible color palettes\n- **`scripts/performance-benchmark.ts`** - Benchmark chart rendering performance\n\n## Quick Start: Building Your First Chart\n\n```typescript\n// 1. Install dependencies\n// npm install recharts framer-motion\n\n// 2. Create a simple line chart\nimport { LineChart, Line, XAxis, YAxis, Tooltip, ResponsiveContainer } from 'recharts';\nimport { motion } from 'framer-motion';\n\nconst data = [\n  { month: 'Jan', value: 400 },\n  { month: 'Feb', value: 300 },\n  { month: 'Mar', value: 600 },\n];\n\nexport const SalesChart = () => (\n  <motion.div\n    initial={{ opacity: 0, y: 20 }}\n    animate={{ opacity: 1, y: 0 }}\n    transition={{ duration: 0.5 }}\n  >\n    <ResponsiveContainer width=\"100%\" height={300}>\n      <LineChart data={data}>\n        <XAxis dataKey=\"month\" />\n        <YAxis />\n        <Tooltip />\n        <Line\n          type=\"monotone\"\n          dataKey=\"value\"\n          stroke=\"#d97706\"\n          strokeWidth={2}\n          dot={{ fill: '#d97706', r: 4 }}\n        />\n      </LineChart>\n    </ResponsiveContainer>\n  </motion.div>\n);\n\n// 3. Test it\n// 4. Ship it with confidence\n```\n\n---\n\n**Remember:** The best visualization is the one that makes the insight obvious. When in doubt, simplify. When confused, prototype 10 options. When shipping, test ruthlessly.\n\nThis skill guides: Chart selection | Library integration | Testing strategies | Animation patterns | Accessibility compliance | Performance optimization\n"
    }
  ]
}